<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<!-- 배치시작로그 -->
<sqlMap namespace="BATCH.SetBatchGoodsBestSort">
	<typeAlias  alias="commMap" type="com.devwork.common.map.CommonMap"/>
	
	<delete id="deleteGoodsBest_01" parameterClass ="java.util.HashMap">
		<![CDATA[
				Delete from GOODS_BEST
				where DAYS = to_char(sysdate,'yyyymmdd')
		]]>	 
	</delete>
	
	<delete id="deleteGoodsBestRank_02" parameterClass ="java.util.HashMap">
		<![CDATA[
				Delete from GOODS_BEST_RANK
				where DAYS = to_char(sysdate,'yyyymmdd')
		]]>	 
	</delete>
	
	<insert id="insertGoodsBest_01" parameterClass ="java.util.HashMap">
		<![CDATA[
				INSERT INTO GOODS_BEST (GBN,DAYS,APPLY_CHK,ACCESS_NAME)
					SELECT '11',to_char(sysdate,'yyyymmdd'),'N','auto' from dual
					union all	
					SELECT '12',to_char(sysdate,'yyyymmdd'),'N','auto' from dual
					union all	
					SELECT '13',to_char(sysdate,'yyyymmdd'),'N','auto' from dual
					union all	
					SELECT '14',to_char(sysdate,'yyyymmdd'),'N','auto' from dual
					union all	
					SELECT '15',to_char(sysdate,'yyyymmdd'),'N','auto' from dual
					union all	
					SELECT '16',to_char(sysdate,'yyyymmdd'),'N','auto' from dual
					union all	
					SELECT '21',to_char(sysdate,'yyyymmdd'),'N','auto' from dual
					union all	
					SELECT '22',to_char(sysdate,'yyyymmdd'),'N','auto' from dual
					union all	
					SELECT '23',to_char(sysdate,'yyyymmdd'),'N','auto' from dual
					union all	
					SELECT '24',to_char(sysdate,'yyyymmdd'),'N','auto' from dual
					union all	
					SELECT '25',to_char(sysdate,'yyyymmdd'),'N','auto' from dual
		]]>	 
	</insert>
	
	<insert id="insertGoodsBestRank_02" parameterClass ="java.util.HashMap">
		<![CDATA[
				INSERT INTO GOODS_BEST_RANK (DAYS,GBN,GOODS_IDN,GOODS_CODE,CATEGORY_CODE,RANK, IMG_TYPE)
					SELECT TO_CHAR(SYSDATE,'YYYYMMDD'),A.GBN,A.GOODS_IDN,A.GOODS_CODE,B.CATEGORY_CODE,'11' ,A.IMG_TYPE 
					FROM GOODS_BEST_RANK A , GOODS_MASTER B 
					WHERE A.GOODS_IDN = B.GOODS_IDN
					  AND A.DAYS =TO_CHAR(SYSDATE-1,'YYYYMMDD')
		]]>	 
	</insert>
	
	<select id="ORDER_SUBMIT_01" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT /*+ leading(a) use_nl(a b) index(c PK_GOODS_MASTER ) */
			      	    C.GOODS_IDN as iGoodsIdn,
			      	    C.GOODS_CODE as sGoodsCode, 
			      	    c.category_code as sCateGory_Code, 
			      	    count(a.txorder_id) as iCnt, 
			      	    SUM(B.PRICE)  as iNum, 
			      	    C.GOODS_IMAGE_SUB3 as imgType
		   	  	FROM TXORDER A,
		   	         TXORDER_ITEM B,
		   	         GOODS_MASTER C
		   	    WHERE A.COMPLETE_DATE >= to_char(sysdate-7,'yyyymmdd')
		   	      AND A.COMPLETE_DATE <= to_char(sysdate,'yyyymmdd') || '9999'
		   	      AND A.TXORDER_ID    = B.TXORDER_ID
		   	      AND B.GOODS_IDN     = C.GOODS_IDN
		   	      AND B.GOODS_CODE    = C.GOODS_CODE
		   	      AND substr(C.GOODS_CODE,1,2) <> '70'
		   	      AND substr(C.GOODS_CODE,1,1) <> 'E'
		   	      and C.language = 'KO'
		   	      AND A.STATUS = '5'
		          AND A.CANCEL_STATE  = 'N'
		          and a.RECEV_PO_REGIPOCD in('89903','85414')
			      AND B.GOODS_IDN > 0
				  AND B.PRICE > 0
		        GROUP BY C.GOODS_IDN,C.GOODS_CODE,c.category_code,C.GOODS_IMAGE_SUB3
		        ORDER BY CATEGORY_CODE DESC, iCnt desc,iNum DESC
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_02" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT GOODS_IDN as tGoodsIdn
				FROM GOODS_BEST_RANK
				WHERE CATEGORY_CODE = #sOldCateGoryCode#
				AND RANK = 11
				AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
				AND GBN ='11'                                                                                                                                                                       
		]]>	 
	</select>
	
	<update id="updateGoodsBestRank_01" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #tRank#
				,IMG_TYPE = #imgType#
				WHERE goods_idn = #tGoodsIdn#
				AND GBN = '11'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                                                                                                                                                                       
		]]>	 
	</update>
	
	<delete id="deleteGoodsBestRank_03" parameterClass ="java.util.HashMap">
		<![CDATA[
			    DELETE FROM GOODS_BEST_RANK 
			    WHERE CATEGORY_CODE = #sOldCateGoryCode#
			    AND RANK = 11
			    AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
			    AND GBN ='11'                                                                                                                                                                       
		]]>	 
	</delete>
	
	<select id="ORDER_SUBMIT_03" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt 
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				and gbn  = '11'
				and goods_idn = #iGoodsIdn#                                                                                                                                                                       
		]]>	 
	</select>
	
	<update id="updateGoodsBestRank_02" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #iFixRank#
				,IMG_TYPE = #imgType#
				WHERE goods_idn = #iGoodsIdn#
				AND GBN = '11'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                                                                                                                                                                       
		]]>	 
	</update>
	
	<insert id="insertGoodsBestRank_03" parameterClass ="java.util.HashMap">
		<![CDATA[
				INSERT INTO GOODS_BEST_RANK	(
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK,
												IMG_TYPE
											)
				SELECT 
							to_char(sysdate,'yyyymmdd'),
							'11',
							#iGoodsIdn#,
							#sGoodsCode#,
							#sCateGoryCode#,
							#iFixRank#,
							#imgType# 
				from dual
		]]>	 
	</insert>
	
	<select id="ORDER_SUBMIT_04" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt 
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				and gbn  = '11'
				and goods_idn = #iGoodsIdn#                                                                                                                                                                       
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_03" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				     apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '11'                                                                                                                                                                       
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_10" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    select /*+ leading(a b) use_hash(a b) full(b) */
			    		a.goods_idn as iGoodsIdn,
			    		b.goods_code as sGoodsCode,
			    		b.category_code as sCateGoryCode,
			    		count(*) as iNum,
			    		B.GOODS_IMAGE_SUB3 as imgType
				from wish_goods_master a,  goods_master b
				where a.goods_idn = b.goods_idn
				and a.create_date >= to_char(sysdate-60,'yyyymmdd')
				and a.create_date <= to_char(sysdate,'yyyymmdd') || '9999'
			    and b.language = 'KO'
			    AND substr(b.GOODS_CODE,1,2) <> '70'
			    AND substr(b.GOODS_CODE,1,1) <> 'E'
				group by a.goods_idn,b.goods_code,b.category_code,B.GOODS_IMAGE_SUB3
				ORDER BY CATEGORY_CODE DESC, iNum DESC                                                                                                                                                                       
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_11" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT GOODS_IDN 
				FROM GOODS_BEST_RANK
				WHERE CATEGORY_CODE = #sOldCateGoryCode#
				AND RANK = 11
				AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
				AND GBN ='12'                                                                                                                                                            
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_RANK_04" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #tRank#
				,IMG_TYPE = #imgType#
				WHERE goods_idn = #tGoodsIdn#
				AND GBN = '12'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                                                                                                                                                
		]]>	 
	</update>
	
	<delete id="deleteGOODS_BEST_RANK_04" parameterClass ="java.util.HashMap">
		<![CDATA[
			    DELETE FROM GOODS_BEST_RANK 
			    WHERE CATEGORY_CODE = :sOldCateGory_Code
			    AND RANK = 11
			    AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
			    AND GBN ='12'                                                                                                                               
		]]>	 
	</delete>
	
	<select id="ORDER_SUBMIT_12" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				and gbn  = '12'
				and goods_idn = #iGoodsIdn#                                                                                                                                            
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_RANK_05" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #iFixRank#
				,IMG_TYPE = #imgType#
				WHERE goods_idn = #iGoodsIdn#
				AND GBN = '12'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                                                                                                                                            
		]]>	 
	</update>
	
	<insert id="insertGOODS_BEST_RANK_04" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO GOODS_BEST_RANK (
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK,
												IMG_TYPE
											 )
				SELECT 
							to_char(sysdate,'yyyymmdd'),
							'12',
							#iGoodsIdn#,
							#sGoodsCode#,
							#sCateGoryCode#,
							#iFixRank#,
							#imgType#
				from dual                                                                                                                               
		]]>	 
	</insert>
	
	<select id="ORDER_SUBMIT_13" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '12'                                                                                                                                            
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_06" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				     apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '12'                                                                                                                                            
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_20" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT /*+ leading(a) use_nl(a b) index(c PK_GOODS_MASTER ) */
		      	     C.GOODS_IDN as iGoodsIdn,
		      	     C.GOODS_CODE as sGoodsCode, 
		      	     c.category_code as sCateGory_Code,
		      	     count(a.txorder_id) as iCnt, 
		      	     SUM(B.PRICE) as iNum,
		      	     C.GOODS_IMAGE_SUB3 as imgType
		   	  	FROM TXORDER A,
		   	         TXORDER_ITEM B,
		   	         GOODS_MASTER C
		   	    WHERE A.COMPLETE_DATE >= to_char(sysdate-60,'yyyymmdd')
		   	      AND A.COMPLETE_DATE <= to_char(sysdate,'yyyymmdd') || '9999'
		   	      AND A.TXORDER_ID    = B.TXORDER_ID
		   	      AND B.GOODS_IDN     = C.GOODS_IDN
		   	      AND B.GOODS_CODE    = C.GOODS_CODE
		   	      AND B.GOODS_IDN     in ( select goods_idn from goods_master 
										   where create_date like to_char(add_months(sysdate,-12),'yyyy') || '%'
											 and  language = 'KO'
											 and  status in ('01','05')
										)	 
		   	      AND substr(C.GOODS_CODE,1,2) <> '70'
		   	      AND substr(C.GOODS_CODE,1,1) <> 'E'
		   	      and C.language = 'KO'
		   	      AND A.STATUS = '5'
		          AND A.CANCEL_STATE  = 'N'
			      AND B.GOODS_IDN > 0
				  AND B.PRICE > 0
				  and a.RECEV_PO_REGIPOCD in('89903','85414')
		        GROUP BY C.GOODS_IDN,C.GOODS_CODE,c.category_code,C.GOODS_IMAGE_SUB3
		        ORDER BY CATEGORY_CODE ,iCnt DESC, iNum DESC                                                                                                                                  
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_21" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT GOODS_IDN 
				FROM GOODS_BEST_RANK
				WHERE CATEGORY_CODE = #sOldCateGoryCode#
				AND RANK = 11
				AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
				AND GBN ='13'                                                                                                                              
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_RANK_07" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #tRank#,
				IMG_TYPE = #imgType#		
				WHERE goods_idn = #tGoodsIdn#
				AND GBN = '13'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                                                                                               
		]]>	 
	</update>
	
	<delete id="deleteGOODS_BEST_RANK_05" parameterClass ="java.util.HashMap">
		<![CDATA[
			    DELETE FROM GOODS_BEST_RANK 
			    WHERE CATEGORY_CODE = #sOldCateGoryCode#
			    AND RANK = 11
			    AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
			    AND GBN ='13'                                                                                                                               
		]]>	 
	</delete>
	
	<select id="ORDER_SUBMIT_22" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				and gbn  = '13'
				and goods_idn = #iGoodsIdn#                                                                                                                        
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_RANK_08" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #iFixRank#,
				IMG_TYPE = #imgType#
				WHERE goods_idn = #iGoodsIdn#
				AND GBN = '13'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                                                                                        
		]]>	 
	</update>
	
	<insert id="insertGOODS_BEST_RANK_05" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO GOODS_BEST_RANK (
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK,
												IMG_TYPE
											)
				SELECT 
						to_char(sysdate,'yyyymmdd'),
						'13',
						#iGoodsIdn#,
						#sGoodsCode#,
						#sCateGory_Code#,
						#iFixRank#,
						#imgType# 
				from dual                                                                                                             
		]]>	 
	</insert>
	
	<select id="ORDER_SUBMIT_23" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '13'                                                                                                                      
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_09" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				     apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '13'                                                                                    
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_30" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT /*+ leading(a) use_nl(a b) index(c PK_GOODS_MASTER ) */
			      	     C.GOODS_IDN as iGoodsIdn,
			      	     C.GOODS_CODE as sGoodsCode, 
			      	     c.category_code as sCateGory_Code,
			      	     count(a.txorder_id) as iCnt, 
			      	     SUM(B.PRICE) as iNum,
			      	     C.GOODS_IMAGE_SUB3 as imgType
			   	 FROM TXORDER A,
			   	              TXORDER_ITEM B,
			   	              GOODS_MASTER C
			   	    WHERE A.COMPLETE_DATE >= to_char(sysdate-7,'yyyymmdd')
			   	      AND A.COMPLETE_DATE <= to_char(sysdate,'yyyymmdd') || '9999'
			   	      AND A.TXORDER_ID    = B.TXORDER_ID
			   	      AND B.GOODS_IDN     = C.GOODS_IDN
			   	      AND B.GOODS_CODE    = C.GOODS_CODE
			   	      AND substr(C.GOODS_CODE,1,2) <> '70'
			   	      AND substr(C.GOODS_CODE,1,1) <> 'E'
			   	      and C.language = 'KO'
			   	      AND A.STATUS = '5'
			   	      AND C.GOODS_IMAGE_SUB3 IS NOT NULL
			          AND A.CANCEL_STATE  = 'N'
			          AND A.RECEV_PO_REGIPOCD in('89903','85414')
			          AND B.GOODS_IDN > 0
			          AND B.PRICE > 0
			        GROUP BY C.GOODS_IDN,C.GOODS_CODE,c.category_code,C.GOODS_IMAGE_SUB3
			        ORDER BY GOODS_IMAGE_SUB3 , iCnt desc,iNum DESC                                                                                
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_31" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT GOODS_IDN 
				FROM GOODS_BEST_RANK
				WHERE img_Type  = #OldimgType#
				AND RANK = 11
				AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
				AND GBN ='14'                                                                                
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_RANK_10" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #tRank#,
				IMG_TYPE = #imgType#
				WHERE goods_idn = #tGoodsIdn#
				AND GBN = '14'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                                                                  
		]]>	 
	</update>
	
	<update id="updateST_GOODS_MASTER_11" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE ST_GOODS_MASTER 
				SET  GOODS_BEST_RANK = #tRank#
				WHERE goods_idn = #tGoodsIdn#                                                                         
		]]>	 
	</update>
	
	<update id="updateGOODS_MASTER_12" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_MASTER 
				SET  GOODS_BEST_RANK = #tRank#
				WHERE goods_idn = #tGoodsIdn#                                                          
		]]>	 
	</update>
	
	<delete id="deleteGOODS_BEST_RANK_06" parameterClass ="java.util.HashMap">
		<![CDATA[
			    DELETE FROM GOODS_BEST_RANK 
			    WHERE img_Type  = #OldimgType#
			    AND RANK = 11
			    AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
			    AND GBN ='14'                                                                                                                              
		]]>	 
	</delete>
	
	<select id="ORDER_SUBMIT_32" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				and gbn  = '14'
				and goods_idn = :iGoodsIdn                                                                                
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_RANK_13" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = :iFixRank,
				IMG_TYPE = :imgType
				WHERE goods_idn = :iGoodsIdn
				AND GBN = '14'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                                                        
		]]>	 
	</update>
	
	<insert id="insertGOODS_BEST_RANK_06" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO GOODS_BEST_RANK (
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK,
												IMG_TYPE
											)
				SELECT 
						to_char(sysdate,'yyyymmdd'),
						'14',
						#iGoodsIdn#,
						#sGoodsCode#,
						#sCateGoryCode#,
						#iFixRank#,
						#imgType# 
				from dual                                                                                                    
		]]>	 
	</insert>
	
	<update id="updateST_GOODS_MASTER_14" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE ST_GOODS_MASTER 
				SET  GOODS_BEST_RANK = :iFixRank
				WHERE goods_idn = :iGoodsIdn                                                       
		]]>	 
	</update>
	
	<update id="updateGOODS_MASTER_15" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_MASTER 
				SET  GOODS_BEST_RANK = #iFixRank#
				WHERE goods_idn = #iGoodsIdn#                                                       
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_33" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '14'                                                       
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_16" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				     apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '14'                                                  
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_40" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    select /*+ leading(a b) use_hash(a b) full(b) */
					    C.GOODS_IDN as iGoodsIdn,
			      	    C.GOODS_CODE as sGoodsCode, 
			      	    c.category_code as sCateGory_Code,
			      	    count(a.txorder_id) as iCnt, 
			      	    SUM(B.PRICE) as iNum,
			      	    C.GOODS_IMAGE_SUB3 as imgType
				from wish_goods_master a,  goods_master b
				where a.goods_idn = b.goods_idn
				and a.create_date >= to_char(sysdate-60,'yyyymmdd')
				and a.create_date <= to_char(sysdate,'yyyymmdd') || '9999'
			    and b.language = 'KO'
			    AND substr(b.GOODS_CODE,1,2) <> '70'
			    AND substr(b.GOODS_CODE,1,1) <> 'E'
			    AND b.GOODS_IMAGE_SUB3 IS NOT NULL
				group by a.goods_idn,b.goods_code,b.category_code,B.GOODS_IMAGE_SUB3
				ORDER BY imgType ,  iNum DESC                                           
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_41" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT GOODS_IDN 
				FROM GOODS_BEST_RANK
				WHERE img_Type  = #OldimgType#
				AND RANK = 11
				AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
				AND GBN ='15'                                      
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_RANK_17" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #tRank#,
				IMG_TYPE = #imgType#
				WHERE goods_idn = #tGoodsIdn#
				AND GBN = '15'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                                         
		]]>	 
	</update>
	
	<update id="updateST_GOODS_MASTER_18" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE ST_GOODS_MASTER 
				SET  GOODS_JIM_RANK = #tRank#
				WHERE goods_idn = #tGoodsIdn#                                            
		]]>	 
	</update>
	
	<update id="updateGOODS_MASTER_19" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_MASTER 
				SET  GOODS_JIM_RANK = #tRank#
				WHERE goods_idn = #tGoodsIdn#                                         
		]]>	 
	</update>
	
	<delete id="deleteGOODS_BEST_RANK_07" parameterClass ="java.util.HashMap">
		<![CDATA[
			    DELETE FROM GOODS_BEST_RANK 
			    WHERE img_Type  = #OldimgType#
			    AND RANK = 11
			    AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
			    AND GBN ='15'                                                                                                                            
		]]>	 
	</delete>
	
	<select id="ORDER_SUBMIT_42" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				and gbn  = '15'
				and goods_idn = #iGoodsIdn#                                   
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_RANK_20" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #iFixRank#,
				IMG_TYPE = #imgType#
				WHERE goods_idn = #iGoodsIdn#
				AND GBN = '15'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                                     
		]]>	 
	</update>
	
	<insert id="insertGOODS_BEST_RANK_07" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO GOODS_BEST_RANK (
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK,
												IMG_TYPE
											)
				SELECT 
						to_char(sysdate,'yyyymmdd'),
						'15',
						#iGoodsIdn#,
						#sGoodsCode#,
						#sCateGoryCode#,
						#iFixRank#,
						#imgType# 
				from dual                                                                                        
		]]>	 
	</insert>
	
	<update id="updateST_GOODS_MASTER_21" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE ST_GOODS_MASTER 
				SET  GOODS_JIM_RANK = #iFixRank#
				WHERE goods_idn = #iGoodsIdn#                                   
		]]>	 
	</update>
	
	<update id="updateGOODS_MASTER_22" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_MASTER 
				SET  GOODS_JIM_RANK = #iFixRank#
				WHERE goods_idn = #iGoodsIdn#                                   
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_43" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '15'                                  
		]]>	 
	</select>
	
	<update id="updateGOODS_MASTER_23" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				         apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '15'                              
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_50" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT /*+ leading(a) use_nl(a b) index(c PK_GOODS_MASTER ) */
		      	     C.GOODS_IDN as iGoodsIdn,
		      	     C.GOODS_CODE as sGoodsCode, 
		      	     c.category_code as sCateGory_Code,
		      	     count(a.txorder_id) as iCnt, 
		      	     SUM(B.PRICE) as iNum,
		      	     C.GOODS_IMAGE_SUB3 as imgType
		   	  	FROM TXORDER A,
		   	         TXORDER_ITEM B,
		   	         GOODS_MASTER C
		   	    WHERE A.COMPLETE_DATE >= to_char(sysdate-60,'yyyymmdd')
		   	      AND A.COMPLETE_DATE <= to_char(sysdate,'yyyymmdd') || '9999'
		   	      AND A.TXORDER_ID    = B.TXORDER_ID
		   	      AND B.GOODS_IDN     = C.GOODS_IDN
		   	      AND B.GOODS_CODE    = C.GOODS_CODE
		   	      AND B.GOODS_IDN     in ( select goods_idn from goods_master 
					                where create_date like to_char(add_months(sysdate,-12),'yyyy') || '%'
						   and  language = 'KO'
						   and  status in ('01','05')
					              )	 
		   	      AND substr(C.GOODS_CODE,1,2) <> '70'
		   	      AND substr(C.GOODS_CODE,1,1) <> 'E'
		   	      and C.language = 'KO'
		   	      AND A.STATUS = '5'
		          	      AND A.CANCEL_STATE  = 'N'
			      AND B.GOODS_IDN > 0
			      AND c.GOODS_IMAGE_SUB3 IS NOT NULL
				  AND B.PRICE > 0
				  and a.RECEV_PO_REGIPOCD in('89903','85414')
		        GROUP BY C.GOODS_IDN,C.GOODS_CODE,c.category_code,C.GOODS_IMAGE_SUB3
		        ORDER BY imgType ,iCnt DESC, iNum DESC                             
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_51" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT GOODS_IDN 
				FROM GOODS_BEST_RANK
				WHERE img_Type  = #OldimgType#
				AND RANK = 11
				AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
				AND GBN ='16'                             
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_RANK_24" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #tRank#,
				IMG_TYPE = #imgType#		
				WHERE goods_idn = #tGoodsIdn#
				AND GBN = '16'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                          
		]]>	 
	</update>
	
	<update id="updateST_GOODS_MASTER_25" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE ST_GOODS_MASTER 
				SET  GOODS_NEW_RANK = #tRank#
				WHERE goods_idn = #tGoodsIdn#                 
		]]>	 
	</update>
	
	<update id="updateGOODS_MASTER_26" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_MASTER 
				SET  GOODS_NEW_RANK = #tRank#
				WHERE goods_idn = #tGoodsIdn#                    
		]]>	 
	</update>
	
	<delete id="deleteGOODS_BEST_RANK_08" parameterClass ="java.util.HashMap">
		<![CDATA[
			    DELETE FROM GOODS_BEST_RANK 
			    WHERE img_Type  = #OldimgType#
			    AND RANK = 11
			    AND DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
			    AND GBN ='16'                                                                                                                           
		]]>	 
	</delete>
	
	<select id="ORDER_SUBMIT_52" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				and gbn  = '16'
				and goods_idn = #iGoodsIdn#                       
		]]>	 
	</select>
	
	<update id="updateGOODS_MASTER_27" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #iFixRank#,
					IMG_TYPE = #imgType#
				WHERE goods_idn = #iGoodsIdn#
				     AND GBN = '16'
				     AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD')                    
		]]>	 
	</update>
	
	<insert id="insertGOODS_BEST_RANK_08" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO GOODS_BEST_RANK (
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK,
												IMG_TYPE
											)
				SELECT 
						to_char(sysdate,'yyyymmdd'),
						'16',
						#iGoodsIdn#,
						#sGoodsCode#,
						#sCateGoryCode#,
						#iFixRank#,
						#imgType# 
				from dual                                                                                        
		]]>	 
	</insert>
	
	<update id="updateST_GOODS_MASTER_28" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE ST_GOODS_MASTER 
				SET  GOODS_NEW_RANK = #iFixRank#
				WHERE goods_idn = #iGoodsIdn#                  
		]]>	 
	</update>
	
	<update id="updateGOODS_MASTER_29" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_MASTER 
				SET  GOODS_NEW_RANK = #iFixRank#
				WHERE goods_idn = #iGoodsIdn#                    
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_53" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '16'                    
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_30" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				     apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '16'               
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_60" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT GOODS_IDN  as iGoodsIdn,
			            GOODS_CODE  as sGoodsCode,
			            category_code  as sCateGory_Code,
			            cnt as iCnt,
			            PRICE  as iNum  
			                FROM (
			                      SELECT /*+ leading(a) use_nl(a b) index(c PK_GOODS_MASTER ) */
			                           C.GOODS_IDN,
			                           C.GOODS_CODE, 
			                           c.category_code,
			                           count(a.txorder_id) cnt, 
			                           SUM(B.PRICE) PRICE
			                         FROM TXORDER A,
			                            TXORDER_ITEM B,
			                            GOODS_MASTER C
			                       WHERE A.COMPLETE_DATE >= to_char(sysdate-7,'yyyymmdd')
			                         AND A.COMPLETE_DATE <= to_char(sysdate,'yyyymmdd') || '9999'
			                         AND A.TXORDER_ID    = B.TXORDER_ID
			                         AND B.GOODS_IDN     = C.GOODS_IDN
			                         AND B.GOODS_CODE    = C.GOODS_CODE
			                      AND C.CATEGORY_CODE IN (
			                                               SELECT DISTINCT CATEGORY_CODE FROM GOODS_BEST_INFO
			                                               WHERE GBN = '21'
			                                         )    
			                         AND substr(C.GOODS_CODE,1,2) <> '70'
			                         AND substr(C.GOODS_CODE,1,1) <> 'E'
			                         and C.language = 'KO'
			                         AND A.STATUS = '5'
			                      AND A.CANCEL_STATE  = 'N'
			                      AND B.GOODS_IDN > 0
			                      AND B.PRICE > 0
			                      and a.RECEV_PO_REGIPOCD in('89903','85414')
			                    GROUP BY C.GOODS_IDN,C.GOODS_CODE,c.category_code
			                    ORDER BY cnt DESC, PRICE DESC
			                ) 
			                WHERE ROWNUM < 101                
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_61" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '21'
				  and category_code = #sCateGory_Code#                
		]]>	 
	</select>
	
	<insert id="insertGOODS_BEST_RANK_09" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO GOODS_BEST_RANK (
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK
											)
				SELECT 
						to_char(sysdate,'yyyymmdd'),
						'21',
						#iGoodsIdn#,
						#sGoodsCode#,
						#sCateGoryCode#,
						#iFixRank# 
				from dual                                                                            
		]]>	 
	</insert>
	
	<select id="ORDER_SUBMIT_62" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '21'             
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_31" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				     apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '21'              
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_70" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT GOODS_IDN  as iGoodsIdn,
			            GOODS_CODE  as sGoodsCode,
			            category_code  as sCateGory_Code,
			            cnt as iCnt,
			            PRICE  as iNum 
				FROM (
			      	SELECT /*+ leading(a) use_nl(a b) index(c PK_GOODS_MASTER ) */
			      	     C.GOODS_IDN,
                   C.GOODS_CODE, 
                   c.category_code,
                   count(a.txorder_id) cnt, 
                   SUM(B.PRICE) PRICE
			   	  	FROM TXORDER A,
			   	         TXORDER_ITEM B,
			   	         GOODS_MASTER C
			   	    WHERE A.COMPLETE_DATE >= to_char(sysdate-7,'yyyymmdd')
			   	      AND A.COMPLETE_DATE <= to_char(sysdate,'yyyymmdd') || '9999'
			   	      AND A.TXORDER_ID    = B.TXORDER_ID
			   	      AND B.GOODS_IDN     = C.GOODS_IDN
			   	      AND B.GOODS_CODE    = C.GOODS_CODE
					  AND C.CATEGORY_CODE IN (
							   	            SELECT DISTINCT CATEGORY_CODE FROM GOODS_BEST_INFO
							   	            WHERE GBN = '22'
							   	      )    
			   	      AND substr(C.GOODS_CODE,1,2) <> '70'
			   	      AND substr(C.GOODS_CODE,1,1) <> 'E'
			   	      and C.language = 'KO'
			   	      AND A.STATUS = '5'
			          AND A.CANCEL_STATE  = 'N'
				      AND B.GOODS_IDN > 0
					  AND B.PRICE > 0
					  and a.RECEV_PO_REGIPOCD in('89903','85414')
			        GROUP BY C.GOODS_IDN,C.GOODS_CODE,c.category_code
			        ORDER BY CNT DESC, PRICE DESC
			    ) 
			    WHERE ROWNUM < 101          
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_71" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '22'
				  and category_code = #sCateGoryCode#                
		]]>	 
	</select>
	
	<insert id="insertGOODS_BEST_RANK_10" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO GOODS_BEST_RANK (
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK
											)
				SELECT 
						to_char(sysdate,'yyyymmdd'),
						'22',
						#iGoodsIdn#,
						#sGoodsCode#,
						#sCateGoryCode#,
						#iFixRank# 
				from dual                                                                            
		]]>	 
	</insert>
	
	<select id="ORDER_SUBMIT_72" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '22'           
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_32" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				     apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '22'            
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_80" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT GOODS_IDN  as iGoodsIdn,
			            GOODS_CODE  as sGoodsCode,
			            category_code  as sCateGory_Code,
			            cnt as iCnt,
			            PRICE  as iNum 
			    FROM (
			      	SELECT /*+ leading(a) use_nl(a b) index(c PK_GOODS_MASTER ) */
			      	       C.GOODS_IDN,
		                   C.GOODS_CODE, 
		                   c.category_code,
		                   count(a.txorder_id) cnt, 
		                   SUM(B.PRICE) PRICE
			   	  	FROM TXORDER A,
			   	         TXORDER_ITEM B,
			   	         GOODS_MASTER C
			   	    WHERE A.COMPLETE_DATE >= to_char(sysdate-7,'yyyymmdd')
			   	      AND A.COMPLETE_DATE <= to_char(sysdate,'yyyymmdd') || '9999'
			   	      AND A.TXORDER_ID    = B.TXORDER_ID
			   	      AND B.GOODS_IDN     = C.GOODS_IDN
			   	      AND B.GOODS_CODE    = C.GOODS_CODE
					  AND C.CATEGORY_CODE IN (
							   	            SELECT DISTINCT CATEGORY_CODE FROM GOODS_BEST_INFO
							   	            WHERE GBN = '23'
							   	      )    
			   	      AND substr(C.GOODS_CODE,1,2) <> '70'
			   	      AND substr(C.GOODS_CODE,1,1) <> 'E'
			   	      and C.language = 'KO'
			   	      AND A.STATUS = '5'
			          AND A.CANCEL_STATE  = 'N'
				      AND B.GOODS_IDN > 0
					  AND B.PRICE > 0
					  and a.RECEV_PO_REGIPOCD in('89903','85414')
			        GROUP BY C.GOODS_IDN,C.GOODS_CODE,c.category_code
			        ORDER BY CNT DESC, PRICE DESC
			    ) 
			    WHERE ROWNUM < 101     
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_81" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '23'
				  and category_code = #sCateGoryCode#     
		]]>	 
	</select>
	
	<insert id="insertGOODS_BEST_RANK_11" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO GOODS_BEST_RANK (
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK
											)
				SELECT 
						to_char(sysdate,'yyyymmdd'),
						'23',
						#iGoodsIdn#,
						#sGoodsCode#,
						#sCateGoryCode#,
						#iFixRank# 
				from dual                                                                           
		]]>	 
	</insert>
	
	<select id="ORDER_SUBMIT_82" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '23'  
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_33" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				     apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '23'         
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_90" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT GOODS_IDN  as iGoodsIdn,
			            GOODS_CODE  as sGoodsCode,
			            category_code  as sCateGory_Code,
			            cnt as iCnt,
			            PRICE  as iNum 
			    FROM (
			      	SELECT /*+ leading(a) use_nl(a b) index(c PK_GOODS_MASTER ) */
			      	       C.GOODS_IDN,
		                   C.GOODS_CODE, 
		                   c.category_code,
		                   count(a.txorder_id) cnt, 
		                   SUM(B.PRICE) PRICE
			   	  	FROM TXORDER A,
			   	         TXORDER_ITEM B,
			   	         GOODS_MASTER C
			   	    WHERE A.COMPLETE_DATE >= to_char(sysdate-7,'yyyymmdd')
			   	      AND A.COMPLETE_DATE <= to_char(sysdate,'yyyymmdd') || '9999'
			   	      AND A.TXORDER_ID    = B.TXORDER_ID
			   	      AND B.GOODS_IDN     = C.GOODS_IDN
			   	      AND B.GOODS_CODE    = C.GOODS_CODE
					  AND C.CATEGORY_CODE IN (
							   	            SELECT DISTINCT CATEGORY_CODE FROM GOODS_BEST_INFO
							   	            WHERE GBN = '24'
							   	      )    
			   	      AND substr(C.GOODS_CODE,1,2) <> '70'
			   	      AND substr(C.GOODS_CODE,1,1) <> 'E'
			   	      and C.language = 'KO'
			   	      AND A.STATUS = '5'
			          AND A.CANCEL_STATE  = 'N'
				      AND B.GOODS_IDN > 0
					  AND B.PRICE > 0
					  and a.RECEV_PO_REGIPOCD in('89903','85414')
			        GROUP BY C.GOODS_IDN,C.GOODS_CODE,c.category_code
			        ORDER BY CNT DESC, PRICE DESC
			    ) 
			    WHERE ROWNUM < 101  
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_91" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '24'
				  and category_code = #sCateGoryCode#
		]]>	 
	</select>
	
	<insert id="insertGOODS_BEST_RANK_12" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO GOODS_BEST_RANK (
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK
											)
				SELECT 
						to_char(sysdate,'yyyymmdd'),
						'24',
						#iGoodsIdn#,
						#sGoodsCode#,
						#sCateGoryCode#,
						#iFixRank# 
				from dual                                                                     
		]]>	 
	</insert>
	
	<select id="ORDER_SUBMIT_92" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '24'
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_34" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				     apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '24'       
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_100" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT GOODS_IDN  as iGoodsIdn,
			            GOODS_CODE  as sGoodsCode,
			            category_code  as sCateGory_Code,
			            cnt as iCnt,
			            PRICE  as iNum 
			   FROM (
			      	SELECT /*+ leading(a) use_nl(a b) index(c PK_GOODS_MASTER ) */
			      	       C.GOODS_IDN,
		                   C.GOODS_CODE, 
		                   c.category_code,
		                   count(a.txorder_id) cnt, 
		                   SUM(B.PRICE) PRICE
			   	  	FROM TXORDER A,
			   	         TXORDER_ITEM B,
			   	         GOODS_MASTER C
			   	    WHERE A.COMPLETE_DATE >= to_char(sysdate-7,'yyyymmdd')
			   	      AND A.COMPLETE_DATE <= to_char(sysdate,'yyyymmdd') || '9999'
			   	      AND A.TXORDER_ID    = B.TXORDER_ID
			   	      AND B.GOODS_IDN     = C.GOODS_IDN
			   	      AND B.GOODS_CODE    = C.GOODS_CODE
					  AND C.CATEGORY_CODE IN (
							   	            SELECT DISTINCT CATEGORY_CODE FROM GOODS_BEST_INFO
							   	            WHERE GBN = '25'
							   	      )    
			   	      AND substr(C.GOODS_CODE,1,2) <> '70'
			   	      AND substr(C.GOODS_CODE,1,1) <> 'E'
			   	      and C.language = 'KO'
			   	      AND A.STATUS = '5'
			          AND A.CANCEL_STATE  = 'N'
				      AND B.GOODS_IDN > 0
					  AND B.PRICE > 0
					  and a.RECEV_PO_REGIPOCD in('89903','85414')
			        GROUP BY C.GOODS_IDN,C.GOODS_CODE,c.category_code
			        ORDER BY CNT DESC, PRICE DESC
			    ) 
			    WHERE ROWNUM < 101
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_101" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '25'
				  and category_code = #sCateGoryCode#
		]]>	 
	</select>
	
	<insert id="insertGOODS_BEST_RANK_13" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO GOODS_BEST_RANK (
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK
											)
				SELECT 
						to_char(sysdate,'yyyymmdd'),
						'25',
						#iGoodsIdn#,
						#sGoodsCode#,
						#sCateGoryCode#,
						#iFixRank# 
				from dual                                                                     
		]]>	 
	</insert>
	
	<select id="ORDER_SUBMIT_102" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn  = '25'
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_35" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				     apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '25'    
		]]>	 
	</update>
	
	<delete id="deleteGOODS_BEST_RANK_09" parameterClass ="java.util.HashMap">
		<![CDATA[
			    DELETE FROM GOODS_BEST_RANK 
				WHERE DAYS =TO_CHAR(SYSDATE,'YYYYMMDD')
				AND GBN ='26'                                                                                                                   
		]]>	 
	</delete>
	
	<select id="ORDER_SUBMIT_110" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT 
					G.GOODS_IDN as iGoodsIdn,
					G.GOODS_CODE as sGoodsCode, 
					G.CATEGORY_CODE as sCateGoryCode,
					ROUND(NVL(SUM(C.QUALITY)/COUNT(C.GOODS_IDN),0)) as iCnt,
					NVL(SUM(C.QUALITY),0) as iNum
				FROM GOODS_MASTER G, SERVICE_SATISFACTION C
				WHERE G.GOODS_IDN = C.GOODS_IDN 
				GROUP BY G.GOODS_IDN,G.GOODS_CODE,G.CATEGORY_CODE
				ORDER BY G.CATEGORY_CODE ,AVG_QUALITY DESC, QUALITY DESC
		]]>	 
	</select>
	
	<select id="ORDER_SUBMIT_111" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				and gbn  = '26'
				and goods_idn = #iGoodsIdn#
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_RANK_36" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST_RANK 
				SET	RANK = #iFixRank#
				WHERE goods_idn = #iGoodsIdn#
				AND GBN = '26'
				AND DAYS = TO_CHAR(SYSDATE,'YYYYMMDD') 
		]]>	 
	</update>
	
	<insert id="insertGOODS_BEST_RANK_14" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO GOODS_BEST_RANK (
												DAYS,
												GBN,
												GOODS_IDN,
												GOODS_CODE,
												CATEGORY_CODE,
												RANK
											)
				SELECT 
						to_char(sysdate,'yyyymmdd'),
						'26',
						#iGoodsIdn#,
						#sGoodsCode#,
						#sCateGoryCode#,
						#iFixRank# 
				from dual                                                                     
		]]>	 
	</insert>
	
	<update id="updateGOODS_BEST_RANK_37" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE ST_GOODS_MASTER 
				SET  GOODS_QUALITY_RANK = #iFixRank#,
				     GOODS_IMAGE_SUB2 = #iCnt#
				WHERE goods_idn = #iGoodsIdn# 
		]]>	 
	</update>
	
	<update id="updateGOODS_BEST_RANK_38" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_MASTER 
				SET  GOODS_QUALITY_RANK = #iFixRank#,
				     GOODS_IMAGE_SUB2 = #iCnt#
				WHERE goods_idn = #iGoodsIdn# 
		]]>	 
	</update>
	
	<select id="ORDER_SUBMIT_112" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			    SELECT count(*) as iCategory_Cnt
				from  GOODS_BEST_RANK
				where days = to_char(sysdate,'yyyymmdd')
				and gbn  = '26'
		]]>	 
	</select>
	
	<update id="updateGOODS_BEST_RANK_39" parameterClass ="java.util.HashMap">
		<![CDATA[
			    UPDATE GOODS_BEST
				SET  apply_date = to_char(sysdate,'yyyymmdd') ,
				     apply_chk = 'Y'
				where days = to_char(sysdate,'yyyymmdd')
				  and gbn = '26'
		]]>	 
	</update>
	
	<insert id="insertSHOP_INFO_TRANS_15" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO SHOP_INFO_TRANS (
												DAYS,
												TRGT_TBL,
												TRGT_TBL_KEY1,
												TRGT_TBL_KEY2,
												SEND_YN,
												SEND_CONT,
												SEND_YMD
											)
				VALUES(
						TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') || SHOP_INFO_TRANS_SEQ.NEXTVAL,
						'GOODS_BEST',
						to_char(sysdate,'yyyymmdd'),
						'DAYS',
						'N',
						'베스트상품정보변경',
						NULL
					  )                                                                
		]]>	 
	</insert>
	
	<insert id="insertSHOP_INFO_TRANS_16" parameterClass ="java.util.HashMap">
		<![CDATA[
			    INSERT INTO SHOP_INFO_TRANS (
												DAYS,
												TRGT_TBL,
												TRGT_TBL_KEY1,
												TRGT_TBL_KEY2,
												SEND_YN,
												SEND_CONT,
												SEND_YMD
											)
				VALUES(
						TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') || SHOP_INFO_TRANS_SEQ.NEXTVAL,
						'GOODS_BEST_RANK',
						to_char(sysdate,'yyyymmdd'),
						'DAYS',
						'N',
						'베스트상품정보변경',
						NULL
					  )                                                                
		]]>	 
	</insert>
	
</sqlMap>
