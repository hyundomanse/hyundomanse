<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="BO.Stat.SalesStat">
	<typeAlias  alias="commMap" type="com.devwork.common.map.CommonMap"/>

	<select id="RetrieveRecevRealSellStat" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			SELECT  TO_CHAR(TO_DATE(SELLCLOSEYMD, 'YYYYMMDD'), 'YYYY-MM-DD')	SELLCLOSEYMD,
                    NVL(SUMSPCLTYSUPPGOODSCNT   , 0)	SUMSPCLTYSUPPGOODSCNT,
					NVL(SUMSPCLTYSUPPAMT        , 0)	SUMSPCLTYSUPPAMT,
					NVL(SUMGOODSPRCLPRC         , 0)	SUMGOODSPRCLPRC,
					NVL(SUMSPCLTYCSFFEE         , 0)	SUMSPCLTYCSFFEE,

					NVL(SUMFLWRDELIVSUPPGOODSCNT, 0)	SUMFLWRDELIVSUPPGOODSCNT,
					NVL(SUMFLWRDELIVRECEVAMT    , 0)	SUMFLWRDELIVRECEVAMT,
					NVL(SUMFLWRDELIVFEE         , 0)	SUMFLWRDELIVFEE,
					NVL(SUMFLWRDELIVCSFFEE      , 0)	SUMFLWRDELIVCSFFEE,

					NVL(SUMPOSTETCSUPPGOODSCNT  , 0)	SUMPOSTETCSUPPGOODSCNT,
					NVL(SUMPOSTETCSUPPAMT       , 0)	SUMPOSTETCSUPPAMT,
					NVL(SUMPOSTETCGOODSPRCLPRC  , 0)	SUMPOSTETCGOODSPRCLPRC,
					NVL(SUMPOSTETCCSFFEE        , 0)	SUMPOSTETCCSFFEE,

                    /* 전통시장/패션B2B 추가 */
	                NVL(SUMTRADITIONMARTGOODSCNT        , 0) SUMTRADITIONMARTGOODSCNT,
	                NVL(SUMTRADITIONMARTAMT        , 0) SUMTRADITIONMARTAMT,
	                NVL(SUMTRADITIONMARTPRC        , 0) SUMTRADITIONMARTPRC,
	                NVL(SUMTRADITIONMARTFEE        , 0) SUMTRADITIONMARTFEE,

	                NVL(SUMFASHIONB2BGOODSCNT        , 0) SUMFASHIONB2BGOODSCNT,
	                NVL(SUMFASHIONB2BAMT        , 0) SUMFASHIONB2BAMT,
	                NVL(SUMFASHIONB2BPRC        , 0) SUMFASHIONB2BPRC,
	                NVL(SUMFASHIONB2BFEE        , 0) SUMFASHIONB2BFEE,
	                /* 전통시장/패션B2B 추가 */

                    NVL(ONSUMSPCLTYSUPPGOODSCNT   , 0)	ONSUMSPCLTYSUPPGOODSCNT,
					NVL(ONSUMSPCLTYSUPPAMT        , 0)	ONSUMSPCLTYSUPPAMT,
					NVL(ONSUMGOODSPRCLPRC         , 0)	ONSUMGOODSPRCLPRC,
					NVL(ONSUMSPCLTYCSFFEE         , 0)	ONSUMSPCLTYCSFFEE,
					NVL(ONSUMSPCLTYEXTMALLFEE     , 0)	ONSUMSPCLTYEXTMALLFEE,

					NVL(ONSUMFLWRDELIVSUPPGOODSCNT, 0)	ONSUMFLWRDELIVSUPPGOODSCNT,
					NVL(ONSUMFLWRDELIVRECEVAMT    , 0)	ONSUMFLWRDELIVRECEVAMT,
					NVL(ONSUMFLWRDELIVFEE         , 0)	ONSUMFLWRDELIVFEE,
					NVL(ONSUMFLWRDELIVCSFFEE      , 0)	ONSUMFLWRDELIVCSFFEE,

					NVL(ONSUMESCROWSUPPGOODSCNT   , 0)	ONSUMESCROWSUPPGOODSCNT,
					NVL(ONSUMESCROWYSUPPAMT       , 0)	ONSUMESCROWYSUPPAMT,
					NVL(ONSUMESCROWGOODSPRCLPRC   , 0)	ONSUMESCROWGOODSPRCLPRC,
					NVL(ONSUMESCROWCSFFEE         , 0)	ONSUMESCROWCSFFEE,

					NVL(ONSUMETCSUPPGOODSCNT      , 0)	ONSUMETCSUPPGOODSCNT,
					NVL(ONSUMETCYSUPPAMT          , 0)	ONSUMETCYSUPPAMT,
					NVL(ONSUMETCGOODSPRCLPRC      , 0)	ONSUMETCGOODSPRCLPRC,
					NVL(ONSUMETCCSFFEE			  , 0)	ONSUMETCCSFFEE,


                    /* 전통시장/패션B2B 추가 */
                    NVL(ONSUMTRADITIONMARTGOODSCNT      , 0) ONSUMTRADITIONMARTGOODSCNT,
                    NVL(ONSUMTRADITIONMARTAMT      , 0) ONSUMTRADITIONMARTAMT,
                    NVL(ONSUMTRADITIONMARTPRC      , 0) ONSUMTRADITIONMARTPRC,
                    NVL(ONSUMTRADITIONMARTFEE      , 0) ONSUMTRADITIONMARTFEE,

                    NVL(ONSUMFASHIONB2BGOODSCNT      , 0) ONSUMFASHIONB2BGOODSCNT,
                    NVL(ONSUMFASHIONB2BAMT      , 0) ONSUMFASHIONB2BAMT,
                    NVL(ONSUMFASHIONB2BPRC      , 0) ONSUMFASHIONB2BPRC,
                    NVL(ONSUMFASHIONB2BFEE      , 0) ONSUMFASHIONB2BFEE,
                    /* 전통시장/패션B2B 추가 */

                    NVL(ONSUMBTBSUPPGOODSCNT    , 0)	ONSUMBTBSUPPGOODSCNT,
					NVL(ONSUMBTBYSUPPAMT        , 0)	ONSUMBTBYSUPPAMT,
					NVL(ONSUMBTBGOODSPRCLPRC    , 0)	ONSUMBTBGOODSPRCLPRC,
					NVL(ONSUMBTBCSFFEE          , 0)	ONSUMBTBCSFFEE,

					NVL(ONSUMOVERSEASUPPGOODSCNT, 0)	ONSUMOVERSEASUPPGOODSCNT,
					NVL(ONSUMOVERSEAYSUPPAMT    , 0)	ONSUMOVERSEAYSUPPAMT,
					0 ONSUMOVERSEAPRCLPRC,
					NVL(ONSUMOVERSEACSFFEE		, 0)	ONSUMOVERSEACSFFEE,

                    NVL(TONSUMGOODSPRCLPRC, 0) + NVL(TONSUMFLWRDELIVFEE, 0) + NVL(TONSUMOVERSEAPRCLPRC, 0) + NVL(TONSUMETCGOODSPRCLPRC, 0) AS TONSUMGOODSPRCLPRC,
                    NVL(TONSUMSPCLTYCSFFEE, 0) + NVL(TONSUMFLWRDELIVCSFFEE, 0) + NVL(TONSUMOVERSEACSFFEE, 0) + NVL(TONSUMETCCSFFEE, 0) AS TONSUMSPCLTYCSFFEE,
                    NVL(TONSUMEXTMALLFEE, 0)	TONSUMEXTMALLFEE,
                    NVL(TONSUMESCROWGOODSPRCLPRC, 0)	TONSUMESCROWGOODSPRCLPRC,
                    NVL(TONSUMESCROWCSFFEE, 0)	TONSUMESCROWCSFFEE,
                    NVL(TONSUMBTBGOODSPRCLPRC, 0)	TONSUMBTBGOODSPRCLPRC,
                    NVL(TONSUMBTBCSFFEE, 0)	TONSUMBTBCSFFEE,
                    0 TSUMSPCLTYCSFFEE,
                    0 TSUMGOODSPRCLPRC
            FROM
            (
                SELECT  /*+ LEADING(B A) USE_HASH(B A) */ A.SELL_CLOSE_YMD SELLCLOSEYMD,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '001', A.GOODS_CNT-A.RETURN_GD_CNT,0))) AS SUMSPCLTYSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS SUMSPCLTYSUPPAMT,
                0 AS SUMGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS SUMSPCLTYCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '005', A.GOODS_CNT-A.RETURN_GD_CNT,0))) AS SUMPOSTETCSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS SUMPOSTETCSUPPAMT,
                0 AS SUMPOSTETCGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS SUMPOSTETCCSFFEE,

                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '014', A.GOODS_CNT-A.RETURN_GD_CNT,0))) AS SUMTRADITIONMARTGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '014', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS SUMTRADITIONMARTAMT,
                0 AS SUMTRADITIONMARTPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '014', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS SUMTRADITIONMARTFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '040', A.GOODS_CNT-A.RETURN_GD_CNT,0))) AS SUMFASHIONB2BGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '040', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS SUMFASHIONB2BAMT,
                0 AS SUMFASHIONB2BPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '040', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS SUMFASHIONB2BFEE,

                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.GOODS_CNT-A.RETURN_GD_CNT,0))) AS SUMFLWRDELIVSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT ,0))) AS SUMFLWRDELIVRECEVAMT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0))) AS SUMFLWRDELIVFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS SUMFLWRDELIVCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_CNT-A.RETURN_GD_CNT,'011', A.GOODS_CNT-A.RETURN_GD_CNT,0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMSPCLTYSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT ,'011', A.SETL_AMT-A.RETURN_GD_AMT, 0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT ,0),0)) AS ONSUMSPCLTYSUPPAMT,
                0 AS ONSUMGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),'011',A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),0)) AS ONSUMSPCLTYCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,'011',A.AMOUNT_EXT_MALL_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,0),0)) AS ONSUMSPCLTYEXTMALLFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.GOODS_CNT-A.RETURN_GD_CNT,'012',A.GOODS_CNT-A.RETURN_GD_CNT,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMFLWRDELIVSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT ,'012',A.SETL_AMT-A.RETURN_GD_AMT,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT   ,0),0)) AS ONSUMFLWRDELIVRECEVAMT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,'012',A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),0)) AS ONSUMFLWRDELIVFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'012',A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMFLWRDELIVCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '004', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMESCROWSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '004', A.SETL_AMT-A.RETURN_GD_AMT ,0),0)) AS ONSUMESCROWYSUPPAMT,
                0  AS ONSUMESCROWGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '004', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMESCROWCSFFEE,

                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_CNT-A.RETURN_GD_CNT, '018', A.GOODS_CNT-A.RETURN_GD_CNT,0),'85414',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMETCSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT, '018', A.SETL_AMT-A.RETURN_GD_AMT  ,0),'85414',DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT    ,0),0)) AS ONSUMETCYSUPPAMT,
                0 AS ONSUMETCGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE, '018', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMETCCSFFEE,

                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '014', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMTRADITIONMARTGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '014', A.SETL_AMT-A.RETURN_GD_AMT ,0),0)) AS ONSUMTRADITIONMARTAMT,
                0 AS ONSUMTRADITIONMARTPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '014', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMTRADITIONMARTFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '040', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMFASHIONB2BGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '040', A.SETL_AMT-A.RETURN_GD_AMT ,0),0)) AS ONSUMFASHIONB2BAMT,
                0 AS ONSUMFASHIONB2BPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '040', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMFASHIONB2BFEE,

                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '006', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMBTBSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '006', A.SETL_AMT-A.RETURN_GD_AMT ,0),0)) AS ONSUMBTBYSUPPAMT,
                0 AS ONSUMBTBGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '006', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMBTBCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '008', A.GOODS_CNT-A.RETURN_GD_CNT,'019', A.GOODS_CNT-A.RETURN_GD_CNT,0),'85414',DECODE(A.RECEV_DIV_CD, '008', A.GOODS_CNT-A.RETURN_GD_CNT,'019', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMOVERSEASUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '008', A.SETL_AMT-A.RETURN_GD_AMT ,'019', A.SETL_AMT-A.RETURN_GD_AMT  ,0),'85414',DECODE(A.RECEV_DIV_CD, '008', A.SETL_AMT-A.RETURN_GD_AMT    ,'019', A.SETL_AMT-A.RETURN_GD_AMT  ,0),0)) AS ONSUMOVERSEAYSUPPAMT,
                0 AS ONSUMOVERSEAPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019',A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMOVERSEACSFFEE
                FROM
                (SELECT  RCOCD,REGIPOCD
                     FROM    PICMT0060
                     WHERE USEYN ='Y'
                    ) B,
                MP_PBSDT0110 A
                WHERE  A.M_REGIPOCD = B.REGIPOCD(+)
                AND    A.RECEV_STUS_CD IN ( 'O02','2')
                AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
                AND A.SELL_CLOSE_YMD <= #search_end_ymd#
                AND A.M_REGIPOCD <> '89976'
                AND A.RECEV_PO_REGIPOCD <> '89958'
            ]]>
            	<isNotEqual property="oRcoCd" compareValue="0">
            		<![CDATA[
					AND B.RCOCD = #oRcoCd#
					]]>
				</isNotEqual>
            	<isEqual property="oStatDivCd" compareValue="01">

					<isEqual property="oRecevSysDivCd" compareValue="02">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="03">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="01">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD NOT IN('89903','85414')
						]]>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="05">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD in('89903','85414')
						]]>
					</isEqual>
				</isEqual>

				<isNotEqual property="oStatDivCd" compareValue="01">

					<isNotEqual property="oRecevSysDivCd" compareValue="0">

						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = '02'
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<isEqual property="oRecevSysDivCd" compareValue="05">
								<![CDATA[
									AND A.RECEV_SYS_DIV_CD IN ( '02','03')
								]]>
							</isEqual>
							<isNotEqual property="oRecevSysDivCd" compareValue="05">
								<![CDATA[
									AND A.RECEV_SYS_DIV_CD = #oRecevSysDivCd#
						      		AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
						      	]]>
							</isNotEqual>
						</isNotEqual>
					</isNotEqual>
				</isNotEqual>
            <![CDATA[
                GROUP BY A.SELL_CLOSE_YMD
            ) A
            ,(
                SELECT  /*+ LEADING(B A) USE_HASH(B A) */
                0 AS TSUMGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TSUMSPCLTYCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0))) AS TSUMFLWRDELIVFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TSUMFLWRDELIVCSFFEE,
                0 AS TSUMPOSTETCGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TSUMPOSTETCCSFFEE,
                0 AS TONSUMGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),'011',A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),0)) AS TONSUMSPCLTYCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,'011',A.AMOUNT_EXT_MALL_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,0),0)) AS TONSUMEXTMALLFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,'012',A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),0)) AS TONSUMFLWRDELIVFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'012',A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TONSUMFLWRDELIVCSFFEE,
                0  AS TONSUMESCROWGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '004', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TONSUMESCROWCSFFEE,
                0 AS TONSUMETCGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE, '018', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TONSUMETCCSFFEE,
                0 AS TONSUMBTBGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '006', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TONSUMBTBCSFFEE,
                0 AS TONSUMOVERSEAPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TONSUMOVERSEACSFFEE
                FROM
                (SELECT  RCOCD,REGIPOCD
                     FROM    PICMT0060
                     WHERE USEYN ='Y'
                    ) B,
                MP_PBSDT0110 A
                WHERE 1 = 1
                AND A.M_REGIPOCD = B.REGIPOCD(+)
                AND A.RECEV_STUS_CD IN ( 'O02','2')
                AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
                AND A.SELL_CLOSE_YMD <= #search_end_ymd#
                AND A.M_REGIPOCD <> '89976'
                AND A.RECEV_PO_REGIPOCD <> '89958'
			]]>

           	<isNotEqual property="oRcoCd" compareValue="0">
           		<![CDATA[
					AND B.RCOCD = #oRcoCd#
				]]>
			</isNotEqual>
           	<isEqual property="oStatDivCd" compareValue="01">

				<isEqual property="oRecevSysDivCd" compareValue="02">
					<![CDATA[
						AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
					]]>
					<isEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
						]]>
					</isEqual>
					<isNotEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
						]]>
					</isNotEqual>
				</isEqual>
				<isEqual property="oRecevSysDivCd" compareValue="03">
					<![CDATA[
						AND A.RECEV_PO_REGIPOCD =#pReceSysDivCd#
					]]>
					<isEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
						]]>
					</isEqual>
					<isNotEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
						]]>
					</isNotEqual>
				</isEqual>
				<isEqual property="oRecevSysDivCd" compareValue="04">
					<![CDATA[
						AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
					]]>
					<isEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
						]]>
					</isEqual>
					<isNotEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
						]]>
					</isNotEqual>
				</isEqual>

				<isEqual property="oRecevSysDivCd" compareValue="01">
					<![CDATA[
						AND A.RECEV_PO_REGIPOCD NOT IN('89903','85414')
					]]>
				</isEqual>

				<isEqual property="oRecevSysDivCd" compareValue="05">
					<![CDATA[
						AND A.RECEV_PO_REGIPOCD in('89903','85414')
					]]>
				</isEqual>
			</isEqual>

			<isNotEqual property="oStatDivCd" compareValue="01">

				<isNotEqual property="oRecevSysDivCd" compareValue="0">

					<isEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_SYS_DIV_CD = '02'
							AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
						]]>
					</isEqual>
					<isNotEqual property="oRecevSysDivCd" compareValue="04">
						<isEqual property="oRecevSysDivCd" compareValue="05">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD IN ( '02','03')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="05">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = #oRecevSysDivCd#
					      		AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
					      	]]>
						</isNotEqual>
					</isNotEqual>
				</isNotEqual>
			</isNotEqual>
        <![CDATA[
            ) B
            ORDER BY SELLCLOSEYMD

		]]>
	</select>

	<select id="RetrieveRecevChungRealSellStat" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			SELECT  COMNCD,
                    COMNCDSHORTNM,
                    NVL(SUMSPCLTYSUPPGOODSCNT             , 0)	SUMSPCLTYSUPPGOODSCNT,
					NVL(SUMSPCLTYSUPPAMT                  , 0)	SUMSPCLTYSUPPAMT,
					NVL(SUMGOODSPRCLPRC                   , 0)	SUMGOODSPRCLPRC,
					NVL(SUMSPCLTYCSFFEE                   , 0)	SUMSPCLTYCSFFEE,
					NVL(SUMFLWRDELIVSUPPGOODSCNT          , 0)	SUMFLWRDELIVSUPPGOODSCNT,
					NVL(SUMFLWRDELIVRECEVAMT              , 0)	SUMFLWRDELIVRECEVAMT,
					NVL(SUMFLWRDELIVFEE                   , 0)	SUMFLWRDELIVFEE,
					NVL(SUMFLWRDELIVCSFFEE                , 0)	SUMFLWRDELIVCSFFEE,
					NVL(SUMPOSTETCSUPPGOODSCNT            , 0)	SUMPOSTETCSUPPGOODSCNT,
					NVL(SUMPOSTETCSUPPAMT                 , 0)	SUMPOSTETCSUPPAMT,
					NVL(SUMPOSTETCGOODSPRCLPRC            , 0)	SUMPOSTETCGOODSPRCLPRC,
					NVL(SUMPOSTETCCSFFEE                  , 0)	SUMPOSTETCCSFFEE,
                    /* 전통시장/패션B2B 추가예정 */
	                NVL(SUMTRADITIONMARTGOODSCNT           , 0) SUMTRADITIONMARTGOODSCNT,
	                NVL(SUMTRADITIONMARTAMT           , 0) SUMTRADITIONMARTAMT,
	                NVL(SUMTRADITIONMARTPRC           , 0) SUMTRADITIONMARTPRC,
	                NVL(SUMTRADITIONMARTFEE           , 0) SUMTRADITIONMARTFEE,
	                NVL(SUMFASHIONB2BGOODSCNT           , 0) SUMFASHIONB2BGOODSCNT,
	                NVL(SUMFASHIONB2BAMT           , 0) SUMFASHIONB2BAMT,
	                NVL(SUMFASHIONB2BPRC           , 0) SUMFASHIONB2BPRC,
	                NVL(SUMFASHIONB2BFEE           , 0) SUMFASHIONB2BFEE,
	                /* 전통시장/패션B2B 추가예정 */

                    NVL(ONSUMSPCLTYSUPPGOODSCNT           , 0)	ONSUMSPCLTYSUPPGOODSCNT,
					NVL(ONSUMSPCLTYSUPPAMT                , 0)	ONSUMSPCLTYSUPPAMT,
					NVL(ONSUMGOODSPRCLPRC                 , 0)	ONSUMGOODSPRCLPRC,
					NVL(ONSUMSPCLTYCSFFEE                 , 0)	ONSUMSPCLTYCSFFEE,
					NVL(ONSUMSPCLTYEXTMALLFEE             , 0)	ONSUMSPCLTYEXTMALLFEE,
					NVL(ONSUMFLWRDELIVSUPPGOODSCNT        , 0)	ONSUMFLWRDELIVSUPPGOODSCNT,
					NVL(ONSUMFLWRDELIVRECEVAMT            , 0)	ONSUMFLWRDELIVRECEVAMT,
					NVL(ONSUMFLWRDELIVFEE                 , 0)	ONSUMFLWRDELIVFEE,
					NVL(ONSUMFLWRDELIVCSFFEE              , 0)	ONSUMFLWRDELIVCSFFEE,
					NVL(ONSUMESCROWSUPPGOODSCNT           , 0)	ONSUMESCROWSUPPGOODSCNT,
					NVL(ONSUMESCROWYSUPPAMT               , 0)	ONSUMESCROWYSUPPAMT,
					NVL(ONSUMESCROWGOODSPRCLPRC           , 0)	ONSUMESCROWGOODSPRCLPRC,
					NVL(ONSUMESCROWCSFFEE                 , 0)	ONSUMESCROWCSFFEE,
					NVL(ONSUMETCSUPPGOODSCNT              , 0)	ONSUMETCSUPPGOODSCNT,
					NVL(ONSUMETCYSUPPAMT                  , 0)	ONSUMETCYSUPPAMT,
					NVL(ONSUMETCGOODSPRCLPRC              , 0)	ONSUMETCGOODSPRCLPRC,
					NVL(ONSUMETCCSFFEE                    , 0)	ONSUMETCCSFFEE,
                    /* 전통시장/패션B2B 추가예정 */
                    NVL(ONSUMTRADITIONMARTGOODSCNT      , 0) ONSUMTRADITIONMARTGOODSCNT,
                    NVL(ONSUMTRADITIONMARTAMT      , 0) ONSUMTRADITIONMARTAMT,
                    NVL(ONSUMTRADITIONMARTPRC      , 0) ONSUMTRADITIONMARTPRC,
                    NVL(ONSUMTRADITIONMARTFEE      , 0) ONSUMTRADITIONMARTFEE,

                    NVL(ONSUMFASHIONB2BGOODSCNT      , 0) ONSUMFASHIONB2BGOODSCNT,
                    NVL(ONSUMFASHIONB2BAMT      , 0) ONSUMFASHIONB2BAMT,
                    NVL(ONSUMFASHIONB2BPRC      , 0) ONSUMFASHIONB2BPRC,
                    NVL(ONSUMFASHIONB2BFEE      , 0) ONSUMFASHIONB2BFEE,
                    /* 전통시장/패션B2B 추가예정 */
                    NVL(ONSUMBTBSUPPGOODSCNT              , 0)	ONSUMBTBSUPPGOODSCNT,
					NVL(ONSUMBTBYSUPPAMT                  , 0)	ONSUMBTBYSUPPAMT,
					NVL(ONSUMBTBGOODSPRCLPRC              , 0)	ONSUMBTBGOODSPRCLPRC,
					NVL(ONSUMBTBCSFFEE                    , 0)	ONSUMBTBCSFFEE,
					NVL(ONSUMOVERSEASUPPGOODSCNT          , 0)	ONSUMOVERSEASUPPGOODSCNT,
					NVL(ONSUMOVERSEAYSUPPAMT              , 0)	ONSUMOVERSEAYSUPPAMT,
					0 ONSUMOVERSEAPRCLPRC,
					NVL(ONSUMOVERSEACSFFEE				  , 0)	ONSUMOVERSEACSFFEE,
                    NVL(TONSUMGOODSPRCLPRC, 0) + NVL(TONSUMFLWRDELIVFEE, 0) + NVL(TONSUMOVERSEAPRCLPRC, 0) + NVL(TONSUMETCGOODSPRCLPRC, 0) AS TONSUMGOODSPRCLPRC,
                    NVL(TONSUMSPCLTYCSFFEE, 0) + NVL(TONSUMFLWRDELIVCSFFEE, 0) + NVL(TONSUMOVERSEACSFFEE, 0) + NVL(TONSUMETCCSFFEE, 0) AS TONSUMSPCLTYCSFFEE,
                    NVL(TONSUMEXTMALLFEE, 0)	TONSUMEXTMALLFEE,
                    NVL(TONSUMESCROWGOODSPRCLPRC, 0)	TONSUMESCROWGOODSPRCLPRC,
                    NVL(TONSUMESCROWCSFFEE, 0)	TONSUMESCROWCSFFEE,
                    NVL(TONSUMBTBGOODSPRCLPRC, 0)	TONSUMBTBGOODSPRCLPRC,
                    NVL(TONSUMBTBCSFFEE, 0)	TONSUMBTBCSFFEE,
                    0 TSUMSPCLTYCSFFEE,
                    0 TSUMSPCLTYCSFFEE
            FROM
            (
                SELECT  B.RCOCD COMNCD,
                NVL((SELECT F_GET_COMN_CD_NM('RCO_CD', B.RCOCD) FROM DUAL),'비추천') COMNCDSHORTNM,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '001', A.GOODS_CNT-A.RETURN_GD_CNT,0))) AS SUMSPCLTYSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS SUMSPCLTYSUPPAMT,
                0 AS SUMGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS SUMSPCLTYCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.GOODS_CNT-A.RETURN_GD_CNT,0))) AS SUMFLWRDELIVSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT ,0))) AS SUMFLWRDELIVRECEVAMT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0))) AS SUMFLWRDELIVFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS SUMFLWRDELIVCSFFEE,

                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '014', A.GOODS_CNT-A.RETURN_GD_CNT,0))) AS SUMTRADITIONMARTGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '014', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS SUMTRADITIONMARTAMT,
                0 AS SUMTRADITIONMARTPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '014', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS SUMTRADITIONMARTFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '040', A.GOODS_CNT-A.RETURN_GD_CNT,0))) AS SUMFASHIONB2BGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '040', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS SUMFASHIONB2BAMT,
                0 AS SUMFASHIONB2BPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '040', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS SUMFASHIONB2BFEE,

                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '005', A.GOODS_CNT-A.RETURN_GD_CNT,0))) AS SUMPOSTETCSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS SUMPOSTETCSUPPAMT,
                0 AS SUMPOSTETCGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS SUMPOSTETCCSFFEE,

                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_CNT-A.RETURN_GD_CNT,'011',A.GOODS_CNT-A.RETURN_GD_CNT,0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMSPCLTYSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT ,'011',A.SETL_AMT-A.RETURN_GD_AMT,0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT   ,0),0)) AS ONSUMSPCLTYSUPPAMT,
                0 AS ONSUMGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),'011',A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),0)) AS ONSUMSPCLTYCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,'011',A.AMOUNT_EXT_MALL_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,0),0)) AS ONSUMSPCLTYEXTMALLFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.GOODS_CNT-A.RETURN_GD_CNT,'012',A.GOODS_CNT-A.RETURN_GD_CNT,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMFLWRDELIVSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT ,'012',A.SETL_AMT-A.RETURN_GD_AMT,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT   ,0),0)) AS ONSUMFLWRDELIVRECEVAMT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,'012',A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),0)) AS ONSUMFLWRDELIVFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'012',A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMFLWRDELIVCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '004', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMESCROWSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '004', A.SETL_AMT-A.RETURN_GD_AMT ,0),0)) AS ONSUMESCROWYSUPPAMT,
                0  AS ONSUMESCROWGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '004', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMESCROWCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_CNT-A.RETURN_GD_CNT, '018', A.GOODS_CNT-A.RETURN_GD_CNT,0),'85414',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMETCSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT, '018', A.SETL_AMT-A.RETURN_GD_AMT,0),'85414',DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT  ,0),0)) AS ONSUMETCYSUPPAMT,
                0 AS ONSUMETCGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE, '018', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMETCCSFFEE,

                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '014', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMTRADITIONMARTGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '014', A.SETL_AMT-A.RETURN_GD_AMT ,0),0)) AS ONSUMTRADITIONMARTAMT,
                0 AS ONSUMTRADITIONMARTPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '014', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMTRADITIONMARTFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '040', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMFASHIONB2BGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '040', A.SETL_AMT-A.RETURN_GD_AMT ,0),0)) AS ONSUMFASHIONB2BAMT,
                0 AS ONSUMFASHIONB2BPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '040', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMFASHIONB2BFEE,

                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '006', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMBTBSUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '006', A.SETL_AMT-A.RETURN_GD_AMT ,0),0)) AS ONSUMBTBYSUPPAMT,
                0 AS ONSUMBTBGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '006', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMBTBCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '008', A.GOODS_CNT-A.RETURN_GD_CNT,'019', A.GOODS_CNT-A.RETURN_GD_CNT,0),'85414',DECODE(A.RECEV_DIV_CD, '008', A.GOODS_CNT-A.RETURN_GD_CNT,'019', A.GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS ONSUMOVERSEASUPPGOODSCNT,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '008', A.SETL_AMT-A.RETURN_GD_AMT ,'019', A.SETL_AMT-A.RETURN_GD_AMT,0),'85414' ,DECODE(A.RECEV_DIV_CD, '008', A.SETL_AMT-A.RETURN_GD_AMT ,'019', A.SETL_AMT-A.RETURN_GD_AMT,0),0)) AS ONSUMOVERSEAYSUPPAMT,
                0 AS ONSUMOVERSEAPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS ONSUMOVERSEACSFFEE
                FROM
                (SELECT  RCOCD,REGIPOCD
                     FROM    PICMT0060
                     WHERE USEYN ='Y'
                    ) B,
                MP_PBSDT0110 A
                WHERE  A.M_REGIPOCD = B.REGIPOCD(+)
                AND    A.RECEV_STUS_CD IN ( 'O02','2')
                AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
                AND A.SELL_CLOSE_YMD <= #search_end_ymd#
                AND A.M_REGIPOCD <> '89976'
                AND A.RECEV_PO_REGIPOCD <> '89958'
                ]]>
                <isNotEqual property="oRcoCd" compareValue="0">
                	<![CDATA[
						AND B.RCOCD = #oRcoCd#
					]]>
				</isNotEqual>
	           	<isEqual property="oStatDivCd" compareValue="01">

					<isEqual property="oRecevSysDivCd" compareValue="02">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="03">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD =#pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="01">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD NOT IN('89903','85414')
						]]>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="05">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD in('89903','85414')
						]]>
					</isEqual>
				</isEqual>

				<isNotEqual property="oStatDivCd" compareValue="01">

					<isNotEqual property="oRecevSysDivCd" compareValue="0">

						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = '02'
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<isEqual property="oRecevSysDivCd" compareValue="05">
								<![CDATA[
									AND A.RECEV_SYS_DIV_CD IN ( '02','03')
								]]>
							</isEqual>
							<isNotEqual property="oRecevSysDivCd" compareValue="05">
								<![CDATA[
									AND A.RECEV_SYS_DIV_CD = #oRecevSysDivCd#
						      		AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
						      	]]>
							</isNotEqual>
						</isNotEqual>
					</isNotEqual>
				</isNotEqual>
			<![CDATA[
                GROUP BY B.RCOCD
            ) A
            ,(
                SELECT
                0 AS TSUMGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TSUMSPCLTYCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0))) AS TSUMFLWRDELIVFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TSUMFLWRDELIVCSFFEE,
                0 AS TSUMPOSTETCGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',0,'85414',0,DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TSUMPOSTETCCSFFEE,
                0 AS TONSUMGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),'011',A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),0)) AS TONSUMSPCLTYCSFFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,'011',A.AMOUNT_EXT_MALL_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,0),0)) AS TONSUMEXTMALLFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,'012',A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),0)) AS TONSUMFLWRDELIVFEE,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'012',A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TONSUMFLWRDELIVCSFFEE,
                0  AS TONSUMESCROWGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '004', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TONSUMESCROWCSFFEE,
                0 AS TONSUMETCGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE, '018', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TONSUMETCCSFFEE,
                0 AS TONSUMBTBGOODSPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '006', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TONSUMBTBCSFFEE,
                0 AS TONSUMOVERSEAPRCLPRC,
                SUM(DECODE(A.RECEV_PO_REGIPOCD,'89903',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'85414',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TONSUMOVERSEACSFFEE
                FROM
                (SELECT  RCOCD,REGIPOCD
                     FROM    PICMT0060
                     WHERE USEYN ='Y'
                    ) B,
                MP_PBSDT0110 A
                WHERE  A.M_REGIPOCD = B.REGIPOCD(+)
                AND    A.RECEV_STUS_CD IN ( 'O02','2')
                AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
                AND A.SELL_CLOSE_YMD <= #search_end_ymd#
                AND A.M_REGIPOCD <> '89976'
                AND A.RECEV_PO_REGIPOCD <> '89958'
                ]]>
                <isNotEqual property="oRcoCd" compareValue="0">
                	<![CDATA[
						AND B.RCOCD = #oRcoCd#
					]]>
				</isNotEqual>
	           	<isEqual property="oStatDivCd" compareValue="01">

					<isEqual property="oRecevSysDivCd" compareValue="02">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="03">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD =#pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="01">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD NOT IN('89903','85414')
						]]>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="05">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD in('89903','85414')
						]]>
					</isEqual>
				</isEqual>

				<isNotEqual property="oStatDivCd" compareValue="01">

					<isNotEqual property="oRecevSysDivCd" compareValue="0">

						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = '02'
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<isEqual property="oRecevSysDivCd" compareValue="05">
								<![CDATA[
									AND A.RECEV_SYS_DIV_CD IN ( '02','03')
								]]>
							</isEqual>
							<isNotEqual property="oRecevSysDivCd" compareValue="05">
								<![CDATA[
									AND A.RECEV_SYS_DIV_CD = #oRecevSysDivCd#
						      		AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
						      	]]>
							</isNotEqual>
						</isNotEqual>
					</isNotEqual>
				</isNotEqual>
		<![CDATA[
            ) B
		]]>
	</select>

	<select id="RetrieveSuppRealSellStat" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			SELECT  TO_CHAR(TO_DATE(SELLCLOSEYMD, 'YYYYMMDD'), 'YYYY-MM-DD')	SELLCLOSEYMD,
                NVL(SUMSPCLTYSUPPGOODSCNT           , 0)	SUMSPCLTYSUPPGOODSCNT,
				NVL(SUMSPCLTYSUPPAMT                , 0)	SUMSPCLTYSUPPAMT,
				NVL(SUMGOODSPRCLPRC                 , 0)	SUMGOODSPRCLPRC,
				NVL(SUMSPCLTYCSFFEE                 , 0)	SUMSPCLTYCSFFEE,

				NVL(SUMFLWRDELIVSUPPGOODSCNT        , 0)	SUMFLWRDELIVSUPPGOODSCNT,
				NVL(SUMFLWRDELIVRECEVAMT            , 0)	SUMFLWRDELIVRECEVAMT,
				NVL(SUMFLWRDELIVFEE                 , 0)	SUMFLWRDELIVFEE,
				NVL(SUMFLWRDELIVCSFFEE              , 0)	SUMFLWRDELIVCSFFEE,

				NVL(SUMPOSTETCSUPPGOODSCNT          , 0)	SUMPOSTETCSUPPGOODSCNT,
				NVL(SUMPOSTETCSUPPAMT               , 0)	SUMPOSTETCSUPPAMT,
				NVL(SUMPOSTETCGOODSPRCLPRC          , 0)	SUMPOSTETCGOODSPRCLPRC,
				NVL(SUMPOSTETCCSFFEE                , 0)	SUMPOSTETCCSFFEE,

				/* 전통시장/패션B2B 추가예정 */
                NVL(SUMTRADITIONMARTGOODSCNT      , 0) SUMTRADITIONMARTGOODSCNT,
                NVL(SUMTRADITIONMARTAMT      , 0) SUMTRADITIONMARTAMT,
                NVL(SUMTRADITIONMARTPRC      , 0) SUMTRADITIONMARTPRC,
                NVL(SUMTRADITIONMARTFEE      , 0) SUMTRADITIONMARTFEE,

                NVL(SUMFASHIONB2BGOODSCNT      , 0) SUMFASHIONB2BGOODSCNT,
                NVL(SUMFASHIONB2BAMT      , 0) SUMFASHIONB2BAMT,
                NVL(SUMFASHIONB2BPRC      , 0) SUMFASHIONB2BPRC,
                NVL(SUMFASHIONB2BFEE      , 0) SUMFASHIONB2BFEE,
                /* 전통시장/패션B2B 추가예정 */

                NVL(ONSUMSPCLTYSUPPGOODSCNT         , 0)	ONSUMSPCLTYSUPPGOODSCNT,
				NVL(ONSUMSPCLTYSUPPAMT              , 0)	ONSUMSPCLTYSUPPAMT,
				NVL(ONSUMGOODSPRCLPRC               , 0)	ONSUMGOODSPRCLPRC,
				NVL(ONSUMSPCLTYCSFFEE               , 0)	ONSUMSPCLTYCSFFEE,
				NVL(ONSUMSPCLTYEXTMALLFEE           , 0)	ONSUMSPCLTYEXTMALLFEE,
				NVL(ONSUMFLWRDELIVSUPPGOODSCNT      , 0)	ONSUMFLWRDELIVSUPPGOODSCNT,
				NVL(ONSUMFLWRDELIVRECEVAMT          , 0)	ONSUMFLWRDELIVRECEVAMT,
				NVL(ONSUMFLWRDELIVFEE               , 0)	ONSUMFLWRDELIVFEE,

				NVL(ONSUMFLWRDELIVCSFFEE            , 0)	ONSUMFLWRDELIVCSFFEE,
				NVL(ONSUMESCROWSUPPGOODSCNT         , 0)	ONSUMESCROWSUPPGOODSCNT,
				NVL(ONSUMESCROWYSUPPAMT             , 0)	ONSUMESCROWYSUPPAMT,
				NVL(ONSUMESCROWGOODSPRCLPRC         , 0)	ONSUMESCROWGOODSPRCLPRC,

				NVL(ONSUMESCROWCSFFEE               , 0)	ONSUMESCROWCSFFEE,
				NVL(ONSUMETCSUPPGOODSCNT            , 0)	ONSUMETCSUPPGOODSCNT,
				NVL(ONSUMETCYSUPPAMT                , 0)	ONSUMETCYSUPPAMT,
				NVL(ONSUMETCGOODSPRCLPRC            , 0)	ONSUMETCGOODSPRCLPRC,
				NVL(ONSUMETCCSFFEE                  , 0)	ONSUMETCCSFFEE,
                /* 전통시장/패션B2B 추가예정 */
                NVL(ONSUMTRADITIONMARTGOODSCNT      , 0) ONSUMTRADITIONMARTGOODSCNT,
                NVL(ONSUMTRADITIONMARTAMT      , 0) ONSUMTRADITIONMARTAMT,
                NVL(ONSUMTRADITIONMARTPRC      , 0) ONSUMTRADITIONMARTPRC,
                NVL(ONSUMTRADITIONMARTFEE      , 0) ONSUMTRADITIONMARTFEE,

                NVL(ONSUMFASHIONB2BGOODSCNT      , 0) ONSUMFASHIONB2BGOODSCNT,
                NVL(ONSUMFASHIONB2BAMT      , 0) ONSUMFASHIONB2BAMT,
                NVL(ONSUMFASHIONB2BPRC      , 0) ONSUMFASHIONB2BPRC,
                NVL(ONSUMFASHIONB2BFEE      , 0) ONSUMFASHIONB2BFEE,
                /* 전통시장/패션B2B 추가예정 */
                NVL(ONSUMBTBSUPPGOODSCNT            , 0)	ONSUMBTBSUPPGOODSCNT,
				NVL(ONSUMBTBYSUPPAMT                , 0)	ONSUMBTBYSUPPAMT,
				NVL(ONSUMBTBGOODSPRCLPRC            , 0)	ONSUMBTBGOODSPRCLPRC,
				NVL(ONSUMBTBCSFFEE                  , 0)	ONSUMBTBCSFFEE,
				NVL(ONSUMOVERSEASUPPGOODSCNT        , 0)	ONSUMOVERSEASUPPGOODSCNT,
				NVL(ONSUMOVERSEAYSUPPAMT            , 0)	ONSUMOVERSEAYSUPPAMT,
				NVL(ONSUMOVERSEAPRCLPRC             , 0)	ONSUMOVERSEAPRCLPRC,
				NVL(ONSUMOVERSEACSFFEE				, 0)	ONSUMOVERSEACSFFEE,
                NVL(TONSUMGOODSPRCLPRC, 0) + NVL(TONSUMFLWRDELIVFEE, 0) + NVL(TONSUMOVERSEAPRCLPRC, 0) + NVL(TONSUMETCGOODSPRCLPRC, 0) AS TONSUMGOODSPRCLPRC,
                NVL(TONSUMSPCLTYCSFFEE, 0) + NVL(TONSUMFLWRDELIVCSFFEE, 0) + NVL(TONSUMOVERSEACSFFEE, 0) + NVL(TONSUMETCCSFFEE, 0) AS TONSUMSPCLTYCSFFEE,
                NVL(TONSUMEXTMALLFEE, 0)	TONSUMEXTMALLFEE,
                NVL(TONSUMESCROWGOODSPRCLPRC, 0)	TONSUMESCROWGOODSPRCLPRC,
                NVL(TONSUMESCROWCSFFEE, 0)	TONSUMESCROWCSFFEE,
                NVL(TONSUMBTBGOODSPRCLPRC, 0)	TONSUMBTBGOODSPRCLPRC,
                NVL(TONSUMBTBCSFFEE, 0)	TONSUMBTBCSFFEE,
                NVL(TSUMGOODSPRCLPRC, 0) + NVL(TSUMFLWRDELIVFEE, 0)   + NVL(TSUMPOSTETCGOODSPRCLPRC, 0) AS TSUMGOODSPRCLPRC,
                NVL(TSUMSPCLTYCSFFEE, 0) + NVL(TSUMFLWRDELIVCSFFEE, 0) + NVL(TSUMPOSTETCCSFFEE, 0) AS TSUMSPCLTYCSFFEE
        FROM (
                SELECT  /*+ USE_HASH(B A) */  A.SELL_CLOSE_YMD SELLCLOSEYMD,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS SUMSPCLTYSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT,0),0)) AS SUMSPCLTYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,0),0)) AS SUMGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS SUMSPCLTYCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS SUMFLWRDELIVSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT,0),0)) AS SUMFLWRDELIVRECEVAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),0)) AS SUMFLWRDELIVFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS SUMFLWRDELIVCSFFEE,

                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '014', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS SUMTRADITIONMARTGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '014', A.SETL_AMT-A.RETURN_GD_AMT,0),0)) AS SUMTRADITIONMARTAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '014', A.GOODS_PRCL_PRC,0),0)) AS SUMTRADITIONMARTPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '014', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS SUMTRADITIONMARTFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '040', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS SUMFASHIONB2BGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '040', A.SETL_AMT-A.RETURN_GD_AMT,0),0)) AS SUMFASHIONB2BAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '040', A.GOODS_PRCL_PRC,0),0)) AS SUMFASHIONB2BPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '040', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS SUMFASHIONB2BFEE,

                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS SUMPOSTETCSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT,0),0)) AS SUMPOSTETCSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC,0),0)) AS SUMPOSTETCGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS SUMPOSTETCCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,'011',A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMSPCLTYSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT,'011',A.SETL_AMT-A.RETURN_GD_AMT,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMSPCLTYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,'011',A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,0))) AS ONSUMGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),'011',A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),'03',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0))) AS ONSUMSPCLTYCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,'011',A.AMOUNT_EXT_MALL_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,0))) AS ONSUMSPCLTYEXTMALLFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,'012',A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMFLWRDELIVSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT,'012',A.SETL_AMT-A.RETURN_GD_AMT,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMFLWRDELIVRECEVAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,'012',A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0))) AS ONSUMFLWRDELIVFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'012',A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMFLWRDELIVCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMESCROWSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMESCROWYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.GOODS_PRCL_PRC,0))) AS ONSUMESCROWGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMESCROWCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT, '018', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),'03',DECODE(A.RECEV_DIV_CD, '005', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMETCSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT, '018', A.SETL_AMT-A.RETURN_GD_AMT,0),'03',DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMETCYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC, '018', A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC,0))) AS ONSUMETCGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE, '018', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0)
                                /*
                                ,'03',DECODE(A.RECEV_DIV_CD, '005',
                                DECODE((
                                SELECT COUNT(*) FROM MP_POST_SHOP_SUPP_DAY
                                WHERE SELL_CLOSE_YMD = A.SELL_CLOSE_YMD
                                AND RECEV_DIV_CD = '005'
                                AND GOODS_CD = A.GOODS_CD
                                AND SETL_TYPE_CD = A.SETL_TYPE_CD), 1,A.CSF_FEE, '0')
                                -
                                DECODE((
                                SELECT COUNT(*) FROM MP_POST_SHOP_SUPP_DAY
                                WHERE SELL_CLOSE_YMD = A.SELL_CLOSE_YMD
                                AND RECEV_DIV_CD = '005'
                                AND GOODS_CD = A.GOODS_CD
                                AND SETL_TYPE_CD = A.SETL_TYPE_CD), 1,A.RETURN_GD_CSF_FEE, '0')
                                ,0)
                                */
                                )) AS ONSUMETCCSFFEE,

                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '014', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMTRADITIONMARTGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '014', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMTRADITIONMARTAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '014', A.GOODS_PRCL_PRC,0))) AS ONSUMTRADITIONMARTPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '014', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMTRADITIONMARTFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '040', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMFASHIONB2BGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '040', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMFASHIONB2BAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '040', A.GOODS_PRCL_PRC,0))) AS ONSUMFASHIONB2BPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '040', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMFASHIONB2BFEE,

                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMBTBSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMBTBYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.GOODS_PRCL_PRC,0))) AS ONSUMBTBGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMBTBCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,'019', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT, '019', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMOVERSEASUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.SETL_AMT-A.RETURN_GD_AMT,'019', A.SETL_AMT-A.RETURN_GD_AMT,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.SETL_AMT-A.RETURN_GD_AMT,'019', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMOVERSEAYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.GOODS_PRCL_PRC,'019', A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.GOODS_PRCL_PRC,'019', A.GOODS_PRCL_PRC,0))) AS ONSUMOVERSEAPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE, '019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMOVERSEACSFFEE
            FROM
                    (SELECT  RCOCD,REGIPOCD
                     FROM    PICMT0060
                     WHERE USEYN ='Y'
                    ) B,
                  MP_POST_SHOP_SUPP_DAY A
                WHERE  A.SUPP_PO_REGI_PO_CD = B.REGIPOCD(+)
                AND    A.RECEV_STUS_CD IN ( 'O02','2')
                AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
                AND A.SELL_CLOSE_YMD <= #search_end_ymd#
                AND A.SUPP_PO_REGI_PO_CD NOT IN ('89976','89958')
                ]]>
                <isNotEqual property="oRcoCd" compareValue="0">
                	<![CDATA[
						AND B.RCOCD = #oRcoCd#
					]]>
				</isNotEqual>
	           	<isEqual property="oStatDivCd" compareValue="01">

					<isEqual property="oRecevSysDivCd" compareValue="02">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="03">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD =#pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="01">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD NOT IN('89903','85414')
						]]>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="05">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD in('89903','85414')
						]]>
					</isEqual>
				</isEqual>

				<isNotEqual property="oStatDivCd" compareValue="01">

					<isNotEqual property="oRecevSysDivCd" compareValue="0">

						<isEqual property="oRecevSysDivCd" compareValue="01">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = '05' /* 창구 : 05*/
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="02">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = '01'  /* ePOST 온라인 모바일 제외 */
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="03">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD IN('04','02')  /* 콜센터, 전화*/
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD IN('03','05')  /* 모바일웹, 모바일앱*/
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="05">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD != '05' /* ePOST(전체) 창구제외 : 05*/
							]]>
						</isEqual>

					</isNotEqual>
				</isNotEqual>
			<![CDATA[
                GROUP BY A.SELL_CLOSE_YMD
            ) A
            ,(
                SELECT  /*+ USE_HASH(B A) */
	                    SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,0),0)) AS TSUMGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TSUMSPCLTYCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),0)) AS TSUMFLWRDELIVFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TSUMFLWRDELIVCSFFEE,
    	                SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC,0),0)) AS TSUMPOSTETCGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TSUMPOSTETCCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,'011',A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,0))) AS TONSUMGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),'011',A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),'03',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0))) AS TONSUMSPCLTYCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,'011',A.AMOUNT_EXT_MALL_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,0))) AS TONSUMEXTMALLFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,'012',A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0))) AS TONSUMFLWRDELIVFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'012',A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TONSUMFLWRDELIVCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.GOODS_PRCL_PRC,0))) AS TONSUMESCROWGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TONSUMESCROWCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC, '018', A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC,0))) AS TONSUMETCGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE, '018', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0)
                        		/*
                                ,'03',DECODE(A.RECEV_DIV_CD, '005',
                                DECODE((
                                SELECT COUNT(*) FROM MP_POST_SHOP_SUPP_DAY
                                WHERE SELL_CLOSE_YMD = A.SELL_CLOSE_YMD
                                AND RECEV_DIV_CD = '005'
                                AND GOODS_CD = A.GOODS_CD
                                AND SETL_TYPE_CD = A.SETL_TYPE_CD), 1,A.CSF_FEE, '0')
                                -
                                DECODE((
                                SELECT COUNT(*) FROM MP_POST_SHOP_SUPP_DAY
                                WHERE SELL_CLOSE_YMD = A.SELL_CLOSE_YMD
                                AND RECEV_DIV_CD = '005'
                                AND GOODS_CD = A.GOODS_CD
                                AND SETL_TYPE_CD = A.SETL_TYPE_CD), 1,A.RETURN_GD_CSF_FEE, '0')
                                ,0)
                                */
                                )) AS TONSUMETCCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.GOODS_PRCL_PRC,0))) AS TONSUMBTBGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TONSUMBTBCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.GOODS_PRCL_PRC,0))) AS TONSUMOVERSEAPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TONSUMOVERSEACSFFEE
            FROM
                    (SELECT  RCOCD,REGIPOCD
                     FROM    PICMT0060
                     WHERE USEYN ='Y'
                    ) B,
                  MP_POST_SHOP_SUPP_DAY A
                WHERE  A.SUPP_PO_REGI_PO_CD = B.REGIPOCD(+)
                AND    A.RECEV_STUS_CD IN ( 'O02','2')
                AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
                AND A.SELL_CLOSE_YMD <= #search_end_ymd#
                AND A.SUPP_PO_REGI_PO_CD NOT IN ('89976','89958')
                ]]>
                <isNotEqual property="oRcoCd" compareValue="0">
                	<![CDATA[
						AND B.RCOCD = #oRcoCd#
					]]>
				</isNotEqual>
	           	<isEqual property="oStatDivCd" compareValue="01">

					<isEqual property="oRecevSysDivCd" compareValue="02">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="03">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD =#pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="01">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD NOT IN('89903','85414')
						]]>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="05">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD in('89903','85414')
						]]>
					</isEqual>
				</isEqual>

				<isNotEqual property="oStatDivCd" compareValue="01">

					<isNotEqual property="oRecevSysDivCd" compareValue="0">

						<isEqual property="oRecevSysDivCd" compareValue="01">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = '05' /* 창구 : 05*/
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="02">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = '01'  /* ePOST 온라인 모바일 제외 */
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="03">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD IN('04','02')  /* 콜센터, 전화*/
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD IN('03','05')  /* 모바일웹, 모바일앱*/
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="05">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD != '05' /* ePOST(전체) 창구제외 : 05*/
							]]>
						</isEqual>

					</isNotEqual>
				</isNotEqual>
		<![CDATA[
            ) B
            ORDER BY SELLCLOSEYMD
		]]>
	</select>

	<select id="RetrieveSuppChungRealSellStat" parameterClass ="java.util.HashMap" resultClass="commMap">
		<![CDATA[
			SELECT
				COMNCDSHORTNM,
                NVL(SUMSPCLTYSUPPGOODSCNT,          , 0)	SUMSPCLTYSUPPGOODSCNT,
				NVL(SUMSPCLTYSUPPAMT,               , 0)	SUMSPCLTYSUPPAMT,
				NVL(SUMGOODSPRCLPRC,                , 0)	SUMGOODSPRCLPRC,
				NVL(SUMSPCLTYCSFFEE,                , 0)	SUMSPCLTYCSFFEE,
				NVL(SUMFLWRDELIVSUPPGOODSCNT,       , 0)	SUMFLWRDELIVSUPPGOODSCNT,
				NVL(SUMFLWRDELIVRECEVAMT,           , 0)	SUMFLWRDELIVRECEVAMT,
				NVL(SUMFLWRDELIVFEE,                , 0)	SUMFLWRDELIVFEE,
				NVL(SUMFLWRDELIVCSFFEE,             , 0)	SUMFLWRDELIVCSFFEE,
				NVL(SUMPOSTETCSUPPGOODSCNT,         , 0)	SUMPOSTETCSUPPGOODSCNT,
				NVL(SUMPOSTETCSUPPAMT,              , 0)	SUMPOSTETCSUPPAMT,
				NVL(SUMPOSTETCGOODSPRCLPRC,         , 0)	SUMPOSTETCGOODSPRCLPRC,
				NVL(SUMPOSTETCCSFFEE,               , 0)	SUMPOSTETCCSFFEE,

                /* 전통시장/패션B2B 추가예정 */
                NVL(SUMTRADITIONMARTGOODSCNT      , 0) SUMTRADITIONMARTGOODSCNT,
                NVL(SUMTRADITIONMARTAMT      , 0) SUMTRADITIONMARTAMT,
                NVL(SUMTRADITIONMARTPRC      , 0) SUMTRADITIONMARTPRC,
                NVL(SUMTRADITIONMARTFEE      , 0) SUMTRADITIONMARTFEE,

                NVL(SUMFASHIONB2BGOODSCNT      , 0) SUMFASHIONB2BGOODSCNT,
                NVL(SUMFASHIONB2BAMT      , 0) SUMFASHIONB2BAMT,
                NVL(SUMFASHIONB2BPRC      , 0) SUMFASHIONB2BPRC,
                NVL(SUMFASHIONB2BFEE      , 0) SUMFASHIONB2BFEE,
                /* 전통시장/패션B2B 추가예정 */

                NVL(ONSUMSPCLTYSUPPGOODSCNT,        , 0)	ONSUMSPCLTYSUPPGOODSCNT,
				NVL(ONSUMSPCLTYSUPPAMT,             , 0)	ONSUMSPCLTYSUPPAMT,
				NVL(ONSUMGOODSPRCLPRC,              , 0)	ONSUMGOODSPRCLPRC,
				NVL(ONSUMSPCLTYCSFFEE,              , 0)	ONSUMSPCLTYCSFFEE,
				NVL(ONSUMSPCLTYEXTMALLFEE,          , 0)	ONSUMSPCLTYEXTMALLFEE,
				NVL(ONSUMFLWRDELIVSUPPGOODSCNT,     , 0)	ONSUMFLWRDELIVSUPPGOODSCNT,
				NVL(ONSUMFLWRDELIVRECEVAMT,         , 0)	ONSUMFLWRDELIVRECEVAMT,
				NVL(ONSUMFLWRDELIVFEE,              , 0)	ONSUMFLWRDELIVFEE,
				NVL(ONSUMFLWRDELIVCSFFEE,           , 0)	ONSUMFLWRDELIVCSFFEE,
				NVL(ONSUMESCROWSUPPGOODSCNT,        , 0)	ONSUMESCROWSUPPGOODSCNT,
				NVL(ONSUMESCROWYSUPPAMT,            , 0)	ONSUMESCROWYSUPPAMT,
				NVL(ONSUMESCROWGOODSPRCLPRC,        , 0)	ONSUMESCROWGOODSPRCLPRC,
				NVL(ONSUMESCROWCSFFEE,              , 0)	ONSUMESCROWCSFFEE,
				NVL(ONSUMETCSUPPGOODSCNT,           , 0)	ONSUMETCSUPPGOODSCNT,
				NVL(ONSUMETCYSUPPAMT,               , 0)	ONSUMETCYSUPPAMT,
				NVL(ONSUMETCGOODSPRCLPRC,           , 0)	ONSUMETCGOODSPRCLPRC,
				NVL(ONSUMETCCSFFEE,                 , 0)	ONSUMETCCSFFEE,

                /* 전통시장/패션B2B 추가예정 */
                NVL(ONSUMTRADITIONMARTGOODSCNT      , 0) ONSUMTRADITIONMARTGOODSCNT,
                NVL(ONSUMTRADITIONMARTAMT      , 0) ONSUMTRADITIONMARTAMT,
                NVL(ONSUMTRADITIONMARTPRC      , 0) ONSUMTRADITIONMARTPRC,
                NVL(ONSUMTRADITIONMARTFEE      , 0) ONSUMTRADITIONMARTFEE,

                NVL(ONSUMFASHIONB2BGOODSCNT      , 0) ONSUMFASHIONB2BGOODSCNT,
                NVL(ONSUMFASHIONB2BAMT      , 0) ONSUMFASHIONB2BAMT,
                NVL(ONSUMFASHIONB2BPRC      , 0) ONSUMFASHIONB2BPRC,
                NVL(ONSUMFASHIONB2BFEE      , 0) ONSUMFASHIONB2BFEE,
                /* 전통시장/패션B2B 추가예정 */

                NVL(ONSUMBTBSUPPGOODSCNT,           , 0)	ONSUMBTBSUPPGOODSCNT,
				NVL(ONSUMBTBYSUPPAMT,               , 0)	ONSUMBTBYSUPPAMT,
				NVL(ONSUMBTBGOODSPRCLPRC,           , 0)	ONSUMBTBGOODSPRCLPRC,
				NVL(ONSUMBTBCSFFEE,                 , 0)	ONSUMBTBCSFFEE,
				NVL(ONSUMOVERSEASUPPGOODSCNT,       , 0)	ONSUMOVERSEASUPPGOODSCNT,
				NVL(ONSUMOVERSEAYSUPPAMT,           , 0)	ONSUMOVERSEAYSUPPAMT,
				NVL(ONSUMOVERSEAPRCLPRC,            , 0)	ONSUMOVERSEAPRCLPRC,
				NVL(ONSUMOVERSEACSFFEE,				, 0)	ONSUMOVERSEACSFFEE,
                NVL(TONSUMGOODSPRCLPRC, 0) + NVL(TONSUMFLWRDELIVFEE, 0) + NVL(TONSUMOVERSEAPRCLPRC, 0) + NVL(TONSUMETCGOODSPRCLPRC, 0) AS TONSUMGOODSPRCLPRC,
                NVL(TONSUMSPCLTYCSFFEE, 0) + NVL(TONSUMFLWRDELIVCSFFEE, 0) + NVL(TONSUMOVERSEACSFFEE, 0) + NVL(TONSUMETCCSFFEE, 0) AS TONSUMSPCLTYCSFFEE,
                NVL(TONSUMEXTMALLFEE, 0)	TONSUMEXTMALLFEE,
                NVL(TONSUMESCROWGOODSPRCLPRC, 0)	TONSUMESCROWGOODSPRCLPRC,
                NVL(TONSUMESCROWCSFFEE, 0)	TONSUMESCROWCSFFEE,
                NVL(TONSUMBTBGOODSPRCLPRC, 0)	TONSUMBTBGOODSPRCLPRC,
                NVL(TONSUMBTBCSFFEE, 0)	TONSUMBTBCSFFEE,
                NVL(TSUMGOODSPRCLPRC, 0) + NVL(TSUMFLWRDELIVFEE, 0) + NVL(TSUMPOSTETCGOODSPRCLPRC, 0) AS TSUMGOODSPRCLPRC,
            TSUMSPCLTYCSFFEE+TSUMFLWRDELIVCSFFEE + TSUMPOSTETCCSFFEE AS TSUMSPCLTYCSFFEE
        FROM (
                SELECT  DECODE(NVL(B.RCOCD, ' '), ' ','비추천',(SELECT F_GET_COMN_CD_NM('RCO_CD', B.RCOCD) FROM DUAL)) COMNCDSHORTNM,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS SUMSPCLTYSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT,0),0)) AS SUMSPCLTYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,0),0)) AS SUMGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS SUMSPCLTYCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS SUMFLWRDELIVSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT,0),0)) AS SUMFLWRDELIVRECEVAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),0)) AS SUMFLWRDELIVFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS SUMFLWRDELIVCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS SUMPOSTETCSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT,0),0)) AS SUMPOSTETCSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC,0),0)) AS SUMPOSTETCGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS SUMPOSTETCCSFFEE,

                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '014', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS SUMTRADITIONMARTGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '014', A.SETL_AMT-A.RETURN_GD_AMT,0),0)) AS SUMTRADITIONMARTAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '014', A.GOODS_PRCL_PRC,0),0)) AS SUMTRADITIONMARTPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '014', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS SUMTRADITIONMARTFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '040', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),0)) AS SUMFASHIONB2BGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '040', A.SETL_AMT-A.RETURN_GD_AMT,0),0)) AS SUMFASHIONB2BAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '040', A.GOODS_PRCL_PRC,0),0)) AS SUMFASHIONB2BPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '040', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS SUMFASHIONB2BFEE,

                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,'011',A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMSPCLTYSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT,'011',A.SETL_AMT-A.RETURN_GD_AMT,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMSPCLTYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,'011',A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,0))) AS ONSUMGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),'011',A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),'03',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0))) AS ONSUMSPCLTYCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,'011',A.AMOUNT_EXT_MALL_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,0))) AS ONSUMSPCLTYEXTMALLFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,'012',A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMFLWRDELIVSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT,'012',A.SETL_AMT-A.RETURN_GD_AMT,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMFLWRDELIVRECEVAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,'012',A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0))) AS ONSUMFLWRDELIVFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'012',A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMFLWRDELIVCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMESCROWSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMESCROWYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.GOODS_PRCL_PRC,0))) AS ONSUMESCROWGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMESCROWCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT, '018', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),'03',DECODE(A.RECEV_DIV_CD, '005', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMETCSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT, '018', A.SETL_AMT-A.RETURN_GD_AMT,0),'03',DECODE(A.RECEV_DIV_CD, '005', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMETCYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC, '018', A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC,0))) AS ONSUMETCGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE, '018', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0)
								/*
                                ,'03',DECODE(A.RECEV_DIV_CD, '005',
                                DECODE((
                                SELECT COUNT(*) FROM MP_POST_SHOP_SUPP_DAY
                                WHERE SELL_CLOSE_YMD = A.SELL_CLOSE_YMD
                                AND RECEV_DIV_CD = '005'
                                AND GOODS_CD = A.GOODS_CD
                                AND SETL_TYPE_CD = A.SETL_TYPE_CD), 1,A.CSF_FEE, '0')
                                -
                                DECODE((
                                SELECT COUNT(*) FROM MP_POST_SHOP_SUPP_DAY
                                WHERE SELL_CLOSE_YMD = A.SELL_CLOSE_YMD
                                AND RECEV_DIV_CD = '005'
                                AND GOODS_CD = A.GOODS_CD
                                AND SETL_TYPE_CD = A.SETL_TYPE_CD), 1,A.RETURN_GD_CSF_FEE, '0')
                                ,0)
                                */
                                )) AS ONSUMETCCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '014', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMTRADITIONMARTGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '014', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMTRADITIONMARTAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '014', A.GOODS_PRCL_PRC,0))) AS ONSUMTRADITIONMARTPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '014', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMTRADITIONMARTFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '040', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMFASHIONB2BGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '040', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMFASHIONB2BAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '040', A.GOODS_PRCL_PRC,0))) AS ONSUMFASHIONB2BPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '040', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMFASHIONB2BFEE,

                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMBTBSUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMBTBYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.GOODS_PRCL_PRC,0))) AS ONSUMBTBGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMBTBCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,'019', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,'019', A.SUPP_GOODS_CNT-A.RETURN_GD_CNT,0))) AS ONSUMOVERSEASUPPGOODSCNT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.SETL_AMT-A.RETURN_GD_AMT,'019', A.SETL_AMT-A.RETURN_GD_AMT,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.SETL_AMT-A.RETURN_GD_AMT,'019', A.SETL_AMT-A.RETURN_GD_AMT,0))) AS ONSUMOVERSEAYSUPPAMT,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.GOODS_PRCL_PRC,'019', A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.GOODS_PRCL_PRC,'019', A.GOODS_PRCL_PRC,0))) AS ONSUMOVERSEAPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS ONSUMOVERSEACSFFEE
            FROM
                    (SELECT  DECODE(RCOCD, ' ', NULL, RCOCD) RCOCD,REGIPOCD
                     FROM    PICMT0060
                     WHERE USEYN ='Y'
                    ) B,
                  MP_POST_SHOP_SUPP_DAY A
                WHERE  A.SUPP_PO_REGI_PO_CD = B.REGIPOCD(+)
                AND    A.RECEV_STUS_CD IN ( 'O02','2')
                AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
                AND A.SELL_CLOSE_YMD <= #search_end_ymd#
                AND A.SUPP_PO_REGI_PO_CD NOT IN ('89976','89958')
                ]]>
                <isNotEqual property="oRcoCd" compareValue="0">
                	<![CDATA[
						AND B.RCOCD = #oRcoCd#
					]]>
				</isNotEqual>
	           	<isEqual property="oStatDivCd" compareValue="01">

					<isEqual property="oRecevSysDivCd" compareValue="02">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="03">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD =#pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="01">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD NOT IN('89903','85414')
						]]>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="05">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD in('89903','85414')
						]]>
					</isEqual>
				</isEqual>

				<isNotEqual property="oStatDivCd" compareValue="01">

					<isNotEqual property="oRecevSysDivCd" compareValue="0">

						<isEqual property="oRecevSysDivCd" compareValue="01">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = '05' /* 창구 : 05*/
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="02">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = '01'  /* ePOST 온라인 모바일 제외 */
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="03">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD IN('04','02')  /* 콜센터, 전화*/
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD IN('03','05')  /* 모바일웹, 모바일앱*/
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="05">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD != '05' /* ePOST(전체) 창구제외 : 05*/
							]]>
						</isEqual>

					</isNotEqual>
				</isNotEqual>
			<![CDATA[
                GROUP BY B.RCOCD
            ) A
            ,(
                SELECT  SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,0),0)) AS TSUMGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TSUMSPCLTYCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),0)) AS TSUMFLWRDELIVFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TSUMFLWRDELIVCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC,0),0)) AS TSUMPOSTETCGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'05',DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),0)) AS TSUMPOSTETCCSFFEE,

                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,'011',A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.GOODS_PRCL_PRC,0))) AS TONSUMGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),'011',A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0),'03',DECODE(A.RECEV_DIV_CD, '001', A.CSF_FEE-A.RETURN_GD_CSF_FEE-NVL(A.AMOUNT_EXT_MALL_FEE,0),0))) AS TONSUMSPCLTYCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,'011',A.AMOUNT_EXT_MALL_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '001', A.AMOUNT_EXT_MALL_FEE,0))) AS TONSUMEXTMALLFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,'012',A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.FLWR_DELIV_FEE-A.RETURN_GD_ENT_FEE,0))) AS TONSUMFLWRDELIVFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'012',A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '002', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TONSUMFLWRDELIVCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.GOODS_PRCL_PRC,0))) AS TONSUMESCROWGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '004', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TONSUMESCROWCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC, '018', A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '005', A.GOODS_PRCL_PRC,0))) AS TONSUMETCGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '005', A.CSF_FEE-A.RETURN_GD_CSF_FEE, '018', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0)
                        		/*
                                ,'03',DECODE(A.RECEV_DIV_CD, '005',
                                DECODE((
                                SELECT COUNT(*) FROM MP_POST_SHOP_SUPP_DAY
                                WHERE SELL_CLOSE_YMD = A.SELL_CLOSE_YMD
                                AND RECEV_DIV_CD = '005'
                                AND GOODS_CD = A.GOODS_CD
                                AND SETL_TYPE_CD = A.SETL_TYPE_CD), 1,A.CSF_FEE, '0')
                                -
                                DECODE((
                                SELECT COUNT(*) FROM MP_POST_SHOP_SUPP_DAY
                                WHERE SELL_CLOSE_YMD = A.SELL_CLOSE_YMD
                                AND RECEV_DIV_CD = '005'
                                AND GOODS_CD = A.GOODS_CD
                                AND SETL_TYPE_CD = A.SETL_TYPE_CD), 1,A.RETURN_GD_CSF_FEE, '0')
                                ,0)
                                */
                                )) AS TONSUMETCCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.GOODS_PRCL_PRC,0))) AS TONSUMBTBGOODSPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '006', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TONSUMBTBCSFFEE,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.GOODS_PRCL_PRC,'019', A.GOODS_PRCL_PRC,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.GOODS_PRCL_PRC,'019', A.GOODS_PRCL_PRC,0))) AS TONSUMOVERSEAPRCLPRC,
                        SUM(DECODE(A.RECEV_SYS_DIV_CD,'01',0,DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0),'03',DECODE(A.RECEV_DIV_CD, '008', A.CSF_FEE-A.RETURN_GD_CSF_FEE,'019', A.CSF_FEE-A.RETURN_GD_CSF_FEE,0))) AS TONSUMOVERSEACSFFEE
            	FROM
                    (SELECT  DECODE(RCOCD, ' ', NULL, RCOCD) RCOCD,REGIPOCD
                     FROM    PICMT0060
                     WHERE USEYN ='Y'
                    ) B,
                  MP_POST_SHOP_SUPP_DAY A
                WHERE  A.SUPP_PO_REGI_PO_CD = B.REGIPOCD(+)
                AND    A.RECEV_STUS_CD IN ( 'O02','2')
                AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
                AND A.SELL_CLOSE_YMD <= #search_end_ymd#
                AND A.SUPP_PO_REGI_PO_CD NOT IN ('89976','89958')
            	]]>
                <isNotEqual property="oRcoCd" compareValue="0">
                	<![CDATA[
						AND B.RCOCD = #oRcoCd#
					]]>
				</isNotEqual>
	           	<isEqual property="oStatDivCd" compareValue="01">

					<isEqual property="oRecevSysDivCd" compareValue="02">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="03">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD =#pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>
					<isEqual property="oRecevSysDivCd" compareValue="04">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD = #pReceSysDivCd#
						]]>
						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>
						<isNotEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isNotEqual>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="01">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD NOT IN('89903','85414')
						]]>
					</isEqual>

					<isEqual property="oRecevSysDivCd" compareValue="05">
						<![CDATA[
							AND A.RECEV_PO_REGIPOCD in('89903','85414')
						]]>
					</isEqual>
				</isEqual>

				<isNotEqual property="oStatDivCd" compareValue="01">

					<isNotEqual property="oRecevSysDivCd" compareValue="0">

						<isEqual property="oRecevSysDivCd" compareValue="01">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = '05' /* 창구 : 05*/
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="02">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD = '01'  /* ePOST 온라인 모바일 제외 */
								AND A.RECEV_DIV_CD NOT IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="03">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD IN('04','02')  /* 콜센터, 전화*/
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="04">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD IN('03','05')  /* 모바일웹, 모바일앱*/
								AND A.RECEV_DIV_CD IN('011','012','015','016','017','018','019','020','021','022','031','032','041','042','051','052','061','062')
							]]>
						</isEqual>

						<isEqual property="oRecevSysDivCd" compareValue="05">
							<![CDATA[
								AND A.RECEV_SYS_DIV_CD != '05' /* ePOST(전체) 창구제외 : 05*/
							]]>
						</isEqual>
					</isNotEqual>
				</isNotEqual>
		<![CDATA[
			) B
		]]>
	</select>






	<sql id="statSearchCondition">
		 <isNotEmpty property="search_serviceDivCd">
			  <isEqual property="search_serviceDivCd" compareValue="05"><!-- ePOST(전체) -->
			  	AND A.RECEV_SYS_DIV_CD != '05'
			  </isEqual>
			  <isEqual property="search_serviceDivCd" compareValue="04"><!-- 모바일  -->
			  	AND A.RECEV_SYS_DIV_CD IN ('03','06')
			  </isEqual>
			  <isEqual property="search_serviceDivCd" compareValue="01"><!-- 01 우체국(창구)  -->
			  	AND A.RECEV_SYS_DIV_CD = '05'
			  </isEqual>
			  <isEqual property="search_serviceDivCd" compareValue="01"><!-- 03 콜센터  -->
			  	AND A.RECEV_SYS_DIV_CD = '04'
			  </isEqual>
		 </isNotEmpty>
		 <isNotEmpty property="search_pavlan" >
		 	<isEqual property="search_pavlan" compareValue="01"> <!-- 특산품 -->
		 		AND A.RECEV_DIV_CD IN ('001','008','011','019','020')
		 	</isEqual>
		 	<isEqual property="search_pavlan" compareValue="02"> <!-- 꽃배달 -->
		 		AND A.RECEV_DIV_CD IN ('002','012','016')
		 	</isEqual>
		 	<isEqual property="search_pavlan" compareValue="03"> <!-- 해외배송 -->
		 		AND A.RECEV_DIV_CD IN ('008','019','020','060','061','062')
		 	</isEqual>
		 	<isEqual property="search_pavlan" compareValue="04"> <!-- 제철식품 -->
		 		AND A.RECEV_DIV_CD IN ('005','017','018')
		 	</isEqual>
		 	<isEqual property="search_pavlan" compareValue="05"> <!-- 생활마트 -->
		 		AND A.RECEV_DIV_CD IN ('004','021','022','050','051','052')
		 	</isEqual>
		 	<isEqual property="search_pavlan" compareValue="06"><!-- 전통시장 -->
		 		AND A.RECEV_DIV_CD IN ('014','031','032','060','061','062')
		 	</isEqual>
		 	<isEqual property="search_pavlan" compareValue="07"><!-- 동대문B2B -->
		 		AND A.RECEV_DIV_CD IN ('040','041','042')
		 	</isEqual>

		 </isNotEmpty>
		 <isNotEmpty property="search_supp_comp_id" >
		 AND A.SUPP_COMP_CD = #search_supp_comp_id#
		 </isNotEmpty>
		 <isNotEmpty property="search_goodsNm">
		 AND B.GOODS_NM LIKE '%' || #search_goodsNm# || '%'
		 </isNotEmpty>
		 <isNotEmpty property="search_goodsCd">
		 AND B.GOODS_CD =  #search_goodsCd#
		 </isNotEmpty>
	</sql>
	<sql id="selectStatGoods" >
		SELECT  A.GOODS_CD GOODS_CD,
		        B.GOODS_NM GOODS_NM,
		        NVL(SUM(A.SUPP_GOODS_CNT-A.RETURN_GD_CNT), 0) SUPPGOODSCNT ,
		        NVL(SUM(A.SETL_AMT-A.RETURN_GD_AMT), 0) SETLAMT ,
		        SUM(A.CSF_FEE-A.RETURN_GD_CSF_FEE) CSFFEE ,
		        NVL(SUM(SELL_GOODS_CNT),0) AS SELL_GOODS_CNT
		FROM  MP_POST_SHOP_SUPP_DAY A,
		(
		        SELECT
		        A.GOODS_CD,
		        A.GOODS_NM,
		        T.PAVLN_DIV_CD
		        FROM
		        GD_GOODS_MAST A,
		        GD_CTGRY_PAVLN_MAPP T,
		        GD_GOODS_CTGRY S,
		        (SELECT COMN_CD_ID, COMN_CD_NM FROM CM_COMN_CD WHERE CD_GRP_ID = 'PAVLN_DIV_CD') PAVLN_DIV_CD
		        WHERE 1=1
		        AND S.PAVLN_DIV_CD = PAVLN_DIV_CD.COMN_CD_ID(+)
		        AND S.GOODS_CD = A.GOODS_CD
		        AND S.USE_YN = 'Y'
		        AND S.BASIC_CTGRY_YN ='Y'
		        AND T.PAVLN_DIV_CD = S.PAVLN_DIV_CD
		        AND T.CTGRY_CD = S.CTGRY_CD
		) B
		 WHERE  A.RECEV_STUS_CD IN ( 'O02','2')
		    <![CDATA[ AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
		    AND A.SELL_CLOSE_YMD <= #search_end_ymd# ]]>
		    AND A.RECEV_DIV_CD NOT IN ('004','021','022','050','051','052','006','040','041','042')
		    AND A.GOODS_CD = B.GOODS_CD
		    <include refid="statSearchCondition" />
		    GROUP BY A.GOODS_CD, B.GOODS_NM
	</sql>
	<select id="selectStatGoodsList" 	parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			SELECT *
				FROM ( SELECT
					<isEmpty property="search_SortType">
						ROW_NUMBER () OVER (ORDER BY GOODS_CD DESC) RNUM
					</isEmpty>
					<isEqual property="search_SortType" compareValue ="SETLAMT">
						ROW_NUMBER () OVER (ORDER BY SETLAMT ) RNUM
					</isEqual>
					<isEqual property="search_SortType" compareValue ="SUPPGOODSCNT">
						ROW_NUMBER () OVER (ORDER BY SUPPGOODSCNT ) RNUM
					</isEqual>
					, A.*
					FROM (
							<include refid="selectStatGoods" />
					) A
					) A
		<isNotEmpty property="firstIndex">
			WHERE RNUM BETWEEN  #firstIndex# AND #lastIndex#
		</isNotEmpty>
	</select>
	<select id="selectStatGoodsListCount" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
		SELECT COUNT(*) AS CNT
		  FROM (<include refid="selectStatGoods" />)
	</select>
	<select id="selectStatGoodsListSummary" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
		SUM(SUPPGOODSCNT) SUM_SUPPGOODSCNT,
		SUM(SETLAMT) SUM_SETLAMT,
		SUM(CSFFEE) SUMCSFFEE,
		SUM(SELL_GOODS_CNT) SUM_SELL_GOODS_CNT
		FROM
		(
			<include refid="selectStatGoods" />
		)
	</select>
	<sql id="selectStatPostnet">
	  SELECT
		    PAVLN_DIV_CD,
		    PAVLN_DIV_CD.COMN_CD_NM PAVLN_DIV_NM,
		    B.CTGRY_CD CATEGORY_CD,
		    B.CTGRY_NM CATEGORY_NM,
		    NVL(SUM(A.SUPP_GOODS_CNT-A.RETURN_GD_CNT),0) SUPPGOODSCNT,
		    NVL(SUM(A.SETL_AMT-A.RETURN_GD_AMT),0) SETLAMT,
		    NVL(SUM(SELL_GOODS_CNT),0) AS SELL_GOODS_CNT
		   FROM
		  MP_POST_SHOP_SUPP_DAY A,
		  (
		        SELECT
		        A.GOODS_CD,
		        A.GOODS_NM,
		        T.PAVLN_DIV_CD,
		         GC.CTGRY_CD,
		         GM.CTGRY_NM
		        FROM
		        GD_GOODS_MAST A,
		        GD_CTGRY_PAVLN_MAPP T,
		        GD_GOODS_CTGRY GC,
		        GD_CTGRY_MAST GM
		        WHERE 1=1
		        AND GC.GOODS_CD = A.GOODS_CD
		        AND GC.USE_YN = 'Y'
		        AND GM.USE_YN ='Y'
		        AND GM.CTGRY_CD = GC.CTGRY_CD
		        AND T.PAVLN_DIV_CD = GC.PAVLN_DIV_CD
		        AND GC.BASIC_CTGRY_YN ='Y'
		        AND T.CTGRY_CD = GC.CTGRY_CD
		   <![CDATA[     AND GC.PAVLN_DIV_CD <> '99'  ]]>
		        AND POSTNET_CTGRY_YN ='Y'
		        AND (( GC.PAVLN_DIV_CD IN ('01','04') AND POSTNET_CTGRY_YN ='Y' ) OR ( GC.PAVLN_DIV_CD  NOT IN ('01','04') AND POSTNET_CTGRY_YN ='N' ))
		) B  , PICMT0060 F, (SELECT COMN_CD_ID, COMN_CD_NM FROM CM_COMN_CD WHERE CD_GRP_ID = 'PAVLN_DIV_CD') PAVLN_DIV_CD
		 WHERE 1=1
		    AND B.PAVLN_DIV_CD = PAVLN_DIV_CD.COMN_CD_ID(+)
		    AND A.RECEV_STUS_CD IN ( 'O02','2')
		    AND A.GOODS_CD = B.GOODS_CD(+)
		    AND A.SUPP_PO_REGI_PO_CD = F.REGIPOCD
		    <isEqual property="search_amountType" compareValue="amtParcel"><!-- 소포료기준 -->
		    	 AND F.USEYN='Y'
		    </isEqual>
		    <isEqual property="search_amountType" compareValue="amtSale"><!-- 판매액기준 -->
		    	  AND (F.USEYN='Y' OR F.USEYN IS NULL)
		    </isEqual>
		    <![CDATA[ AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
		    AND A.SELL_CLOSE_YMD <= #search_end_ymd# ]]>
		    AND A.RECEV_DIV_CD NOT IN ('004','021','022','050','051','052','006','040','041','042')
		    AND B.PAVLN_DIV_CD IN ('01','04')
		    <include refid="statSearchCondition" />
		    GROUP bY PAVLN_DIV_CD,PAVLN_DIV_CD.COMN_CD_NM,B.CTGRY_CD, B.CTGRY_NM
		UNION
		   SELECT
		    PAVLN_DIV_CD,
		    PAVLN_DIV_CD.COMN_CD_NM PAVLN_DIV_NM,
		    B.CTGRY_CD CATEGORY_CD,
		    B.CTGRY_NM CATEGORY_NM,
		    NVL(SUM(A.SUPP_GOODS_CNT-A.RETURN_GD_CNT),0) SUPPGOODSCNT,
		    NVL(SUM(A.SETL_AMT-A.RETURN_GD_AMT),0) SETLAMT,
		    NVL(SUM(SELL_GOODS_CNT),0) AS SELL_GOODS_CNT
		   FROM
		  MP_POST_SHOP_SUPP_DAY A,
		  (
		        SELECT
		        A.GOODS_CD,
		        A.GOODS_NM,
		        T.PAVLN_DIV_CD,
		         GC.CTGRY_CD,
		         GM.CTGRY_NM
		        FROM
		        GD_GOODS_MAST A,
		        GD_CTGRY_PAVLN_MAPP T,
		        GD_GOODS_CTGRY GC,
		        GD_CTGRY_MAST GM
		        WHERE 1=1
		        AND GC.GOODS_CD = A.GOODS_CD
		        AND GC.USE_YN = 'Y'
		        AND GM.USE_YN ='Y'
		        AND GC.BASIC_CTGRY_YN ='Y'
		        AND GM.CTGRY_CD = GC.CTGRY_CD
		        AND T.PAVLN_DIV_CD = GC.PAVLN_DIV_CD
		        AND T.CTGRY_CD = GC.CTGRY_CD
		      <![CDATA[    AND GC.PAVLN_DIV_CD <> '99' ]]>
		        AND POSTNET_CTGRY_YN ='N'
		        AND (( GC.PAVLN_DIV_CD IN ('01','04') AND POSTNET_CTGRY_YN ='Y' ) OR ( GC.PAVLN_DIV_CD  NOT IN ('01','04') AND POSTNET_CTGRY_YN ='N' ))
		) B  , PICMT0060 F, (SELECT COMN_CD_ID, COMN_CD_NM FROM CM_COMN_CD WHERE CD_GRP_ID = 'PAVLN_DIV_CD') PAVLN_DIV_CD
		 WHERE 1=1
		    AND B.PAVLN_DIV_CD = PAVLN_DIV_CD.COMN_CD_ID(+)
		    AND A.RECEV_STUS_CD IN ( 'O02','2')
		    AND A.GOODS_CD = B.GOODS_CD(+)
		    AND A.SUPP_PO_REGI_PO_CD = F.REGIPOCD
		    <isEqual property="search_amountType" compareValue="amtParcel"><!-- 소포료기준 -->
		    	 AND F.USEYN='Y'
		    </isEqual>
		    <isEqual property="search_amountType" compareValue="amtSale"><!-- 판매액기준 -->
		    	  AND (F.USEYN='Y' OR F.USEYN IS NULL)
		    </isEqual>
		      <![CDATA[ AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
		    AND A.SELL_CLOSE_YMD <= #search_end_ymd# ]]>
		    AND A.RECEV_DIV_CD NOT IN ('004','021','022','050','051','052','006','040','041','042')
		    AND B.PAVLN_DIV_CD NOT IN ('01','04')
		     <include refid="statSearchCondition" />
		    GROUP BY PAVLN_DIV_CD,PAVLN_DIV_CD.COMN_CD_NM,B.CTGRY_CD, B.CTGRY_NM
	</sql>
	<select id="selectStatPostnetList" 	parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			SELECT *
				FROM ( SELECT
					<isEmpty property="search_SortType">
						ROW_NUMBER () OVER (ORDER BY PAVLN_DIV_CD , CATEGORY_NM ASC) RNUM
					</isEmpty>
					<isEqual property="search_SortType" compareValue="SETLAMT">
						ROW_NUMBER () OVER (ORDER BY SETLAMT) RNUM
					</isEqual>
					<isEqual property="search_SortType" compareValue="SUPPGOODSCNT">
						ROW_NUMBER () OVER (ORDER BY SUPPGOODSCNT) RNUM
					</isEqual>
					<isEqual property="search_SortType" compareValue="CATEGORY_NM">
						ROW_NUMBER () OVER (ORDER BY CATEGORY_NM) RNUM
					</isEqual>
					, A.*
					FROM (
							<include refid="selectStatPostnet" />
					) A
					) A
		<isNotEmpty property="firstIndex">
			WHERE RNUM BETWEEN  #firstIndex# AND #lastIndex#
		</isNotEmpty>
	</select>
	<select id="selectStatPostnetListCount" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
		SELECT COUNT(*) AS CNT
		  FROM (<include refid="selectStatPostnet" />)
	</select>
	<select id="selectStatPostnetListSummary" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
		SUM(SUPPGOODSCNT) SUM_SUPPGOODSCNT,
		SUM(SETLAMT) SUM_SETLAMT,
		SUM(SELL_GOODS_CNT) SUM_SELL_GOODS_CNT
		FROM
		(
			<include refid="selectStatPostnet" />
		)
	</select>
	<sql id="selectStatEpost">
	SELECT
		PAVLN_DIV_CD,
        PAVLN_DIV_CD.COMN_CD_NM PAVLN_DIV_NM,
        B.CTGRY_CD CATEGORY_CD,
        B.CTGRY_NM CATEGORY_NM,
        NVL(SUM(A.SUPP_GOODS_CNT-A.RETURN_GD_CNT),0) SUPPGOODSCNT,
        NVL(SUM(A.SETL_AMT-A.RETURN_GD_AMT),0) SETLAMT,
        NVL(SUM(SELL_GOODS_CNT),0) AS SELL_GOODS_CNT
    FROM    MP_POST_SHOP_SUPP_DAY a,
    (SELECT
        A.GOODS_CD,
        A.GOODS_NM,
        T.PAVLN_DIV_CD,
         GC.CTGRY_CD,
         GM.CTGRY_NM
        FROM
        GD_GOODS_MAST A,
        GD_CTGRY_PAVLN_MAPP T,
        GD_GOODS_CTGRY GC,
        GD_CTGRY_MAST GM
        WHERE 1=1
        AND GC.GOODS_CD = A.GOODS_CD
        AND GC.USE_YN = 'Y'
        AND GM.USE_YN ='Y'
        AND GC.BASIC_CTGRY_YN ='Y'
        AND GM.CTGRY_CD = GC.CTGRY_CD
        AND T.PAVLN_DIV_CD = GC.PAVLN_DIV_CD
        AND T.CTGRY_CD = GC.CTGRY_CD
         <![CDATA[ AND GC.PAVLN_DIV_CD <> '99' ]]>
        AND POSTNET_CTGRY_YN ='N'
       )B, PICMT0060 F, (SELECT COMN_CD_ID, COMN_CD_NM FROM CM_COMN_CD WHERE CD_GRP_ID = 'PAVLN_DIV_CD') PAVLN_DIV_CD
    WHERE 1=1
    AND B.PAVLN_DIV_CD = PAVLN_DIV_CD.COMN_CD_ID(+)
    AND A.RECEV_STUS_CD IN ( 'O02','2')
    AND A.GOODS_CD = B.GOODS_CD(+)
    AND A.SUPP_PO_REGI_PO_CD = F.REGIPOCD
    <isEqual property="search_amountType" compareValue="amtParcel"><!-- 소포료기준 -->
    AND F.USEYN='Y'
    </isEqual>
    <isEqual property="search_amountType" compareValue="amtSale"><!-- 판매액기준 -->
    AND (F.USEYN='Y' OR F.USEYN IS NULL)
    </isEqual>
     <![CDATA[ AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
	AND A.SELL_CLOSE_YMD <= #search_end_ymd# ]]>
    AND A.RECEV_DIV_CD NOT IN ('004','021','022','050','051','052','006','040','041','042')
     <include refid="statSearchCondition" />
    GROUP BY  PAVLN_DIV_CD,PAVLN_DIV_CD.COMN_CD_NM,B.CTGRY_CD, B.CTGRY_NM
	</sql>
	<select id="selectStatEpostList" 	parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			SELECT *
				FROM ( SELECT
					<isEmpty property="search_SortType">
						ROW_NUMBER () OVER (ORDER BY PAVLN_DIV_CD , CATEGORY_NM ASC) RNUM
					</isEmpty>
					<isEqual property="search_SortType" compareValue="SETLAMT">
						ROW_NUMBER () OVER (ORDER BY SETLAMT) RNUM
					</isEqual>
					<isEqual property="search_SortType" compareValue="SUPPGOODSCNT">
						ROW_NUMBER () OVER (ORDER BY SUPPGOODSCNT) RNUM
					</isEqual>
					<isEqual property="search_SortType" compareValue="CATEGORY_NM">
						ROW_NUMBER () OVER (ORDER BY CATEGORY_NM) RNUM
					</isEqual>
					, A.*
					FROM (
							<include refid="selectStatEpost" />
					) A
					) A
		<isNotEmpty property="firstIndex">
			WHERE RNUM BETWEEN  #firstIndex# AND #lastIndex#
		</isNotEmpty>
	</select>
	<select id="selectStatEpostListCount" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
		SELECT COUNT(*) AS CNT
		  FROM (<include refid="selectStatEpost" />)
	</select>
	<select id="selectStatEpostListSummary" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
		SUM(SUPPGOODSCNT) SUM_SUPPGOODSCNT,
		SUM(SETLAMT) SUM_SETLAMT,
		SUM(SELL_GOODS_CNT) SUM_SELL_GOODS_CNT
		FROM
		(
			<include refid="selectStatEpost" />
		)
	</select>
	<sql id="selectStatSupply">
	   SELECT
            B.SUPP_COMP_ID ,
            B.BCNC_NM ,
            NVL(SUM(A.SUPP_GOODS_CNT-A.RETURN_GD_CNT),0) SUPPGOODSCNT,
            NVL(SUM(A.SETL_AMT-A.RETURN_GD_AMT),0) SETLAMT,
            NVL(SUM(SELL_GOODS_CNT),0) AS SELL_GOODS_CNT
        FROM    MP_POST_SHOP_SUPP_DAY A,
       ( SELECT
            A.GOODS_CD,
            A.GOODS_NM,
            T.PAVLN_DIV_CD,
            A.SUPPO_RGIST_POCD,
            A.SUPP_COMP_ID,
            CO.BCNC_NM
        FROM
        GD_GOODS_MAST A,
        GD_CTGRY_PAVLN_MAPP T,
        GD_GOODS_CTGRY S,
        CO_SUPP_COMP_MAST CO
        WHERE 1=1
        AND S.GOODS_CD = A.GOODS_CD
        AND S.USE_YN = 'Y'
        AND S.BASIC_CTGRY_YN ='Y'
        AND A.SUPP_COMP_ID = CO.SUPP_COMP_ID(+)
        AND T.PAVLN_DIV_CD = S.PAVLN_DIV_CD
        AND T.CTGRY_CD = S.CTGRY_CD
        )B , PICMT0060 D
        WHERE 1=1
            AND A.RECEV_STUS_CD IN ( 'O02','2')
            AND A.GOODS_CD = B.GOODS_CD(+)
            AND A.SUPP_PO_REGI_PO_CD = D.REGIPOCD
            <isEqual property="search_amountType" compareValue="amtParcel"><!-- 소포료기준 -->
		    AND D.USEYN='Y'
		    </isEqual>
		    <isEqual property="search_amountType" compareValue="amtSale"><!-- 판매액기준 -->
		    AND (D.USEYN='Y' OR D.USEYN IS NULL)
		    </isEqual>
            <![CDATA[ AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
	        AND A.SELL_CLOSE_YMD <= #search_end_ymd# ]]>
            AND A.RECEV_DIV_CD NOT IN ('004','021','022','050','051','052','006','040','041','042')
             <include refid="statSearchCondition" />
        GROUP BY   B.SUPP_COMP_ID ,  B.BCNC_NM
	</sql>
	<select id="selectStatSupplyList" 	parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			SELECT *
				FROM ( SELECT
					<isEmpty property="search_SortType">
						ROW_NUMBER () OVER (ORDER BY BCNC_NM ASC) RNUM
					</isEmpty>
					<isEqual property="search_SortType" compareValue="SETLAMT">
						ROW_NUMBER () OVER (ORDER BY SETLAMT) RNUM
					</isEqual>
					<isEqual property="search_SortType" compareValue="SUPPGOODSCNT">
						ROW_NUMBER () OVER (ORDER BY SUPPGOODSCNT) RNUM
					</isEqual>
					, A.*
					FROM (
							<include refid="selectStatSupply" />
					) A
					) A
		<isNotEmpty property="firstIndex">
			WHERE RNUM BETWEEN  #firstIndex# AND #lastIndex#
		</isNotEmpty>
	</select>
	<select id="selectStatSupplyListCount" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
		SELECT COUNT(*) AS CNT
		  FROM (<include refid="selectStatSupply" />)
	</select>
	<select id="selectStatSupplyListSummary" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
		SUM(SUPPGOODSCNT) SUM_SUPPGOODSCNT,
		SUM(SETLAMT) SUM_SETLAMT,
		SUM(SELL_GOODS_CNT) SUM_SELL_GOODS_CNT
		FROM
		(
			<include refid="selectStatSupply" />
		)
	</select>
	<sql id="selectStatGoodsSupply">
	SELECT     PAVLN_DIV_CD ,
               PAVLN_DIV_CD.COMN_CD_NM  PAVLN_DIV_NM,
                B.CTGRY_CD CATEGORY_CD,
                B.CTGRY_NM CATEGORY_NM,
                CASE WHEN b.SUPP_COMP_ID IS NULL AND PAVLN_DIV_CD IS NULL THEN ''
                     WHEN b.SUPP_COMP_ID IS NULL AND PAVLN_DIV_CD IS NOT NULL THEN '소계'
                     ELSE SUPP_COMP_ID END SUPP_COMP_ID,
                B.BCNC_NM ,
                NVL(SUM(A.SUPP_GOODS_CNT-A.RETURN_GD_CNT),0) SUPPGOODSCNT,
                NVL(SUM(A.SETL_AMT-A.RETURN_GD_AMT),0) SETLAMT,
                NVL(SUM(SELL_GOODS_CNT),0) AS SELL_GOODS_CNT
    FROM    MP_POST_SHOP_SUPP_DAY A,
            PICMT0060 F,
    (
      SELECT
            A.GOODS_CD,
            A.GOODS_NM,
            T.PAVLN_DIV_CD,
            A.SUPPO_RGIST_POCD,
            A.SUPP_COMP_ID,
            CO.BCNC_NM,
            GCM.CTGRY_CD,
            GCM.CTGRY_NM
        FROM
        GD_GOODS_MAST A,
        GD_CTGRY_PAVLN_MAPP T,
        GD_GOODS_CTGRY S,
        GD_CTGRY_MAST GCM,
        CO_SUPP_COMP_MAST CO
        WHERE 1=1
        AND S.GOODS_CD = A.GOODS_CD
        AND S.USE_YN = 'Y'
        AND S.BASIC_CTGRY_YN ='Y'
        AND A.SUPP_COMP_ID = CO.SUPP_COMP_ID(+)
        AND T.PAVLN_DIV_CD = S.PAVLN_DIV_CD
        AND T.CTGRY_CD = S.CTGRY_CD
        AND GCM.CTGRY_CD = S.CTGRY_CD

       <![CDATA[  AND T.PAVLN_DIV_CD <> '99'  ]]>
        AND GCM.POSTNET_CTGRY_YN ='Y'
        AND T.PAVLN_DIV_CD IN ('01','04')
        UNION
        SELECT
            A.GOODS_CD,
            A.GOODS_NM,
            T.PAVLN_DIV_CD,
            A.SUPPO_RGIST_POCD,
            A.SUPP_COMP_ID,
            CO.BCNC_NM,
            GCM.CTGRY_CD,
            GCM.CTGRY_NM
        FROM
        GD_GOODS_MAST A,
        GD_CTGRY_PAVLN_MAPP T,
        GD_GOODS_CTGRY S,
        GD_CTGRY_MAST GCM,
        CO_SUPP_COMP_MAST CO
        WHERE 1=1
        AND S.GOODS_CD = A.GOODS_CD
        AND S.USE_YN = 'Y'
        AND S.BASIC_CTGRY_YN ='Y'
        AND A.SUPP_COMP_ID = CO.SUPP_COMP_ID(+)
        AND T.PAVLN_DIV_CD = S.PAVLN_DIV_CD
        AND T.CTGRY_CD = S.CTGRY_CD
        AND GCM.CTGRY_CD = S.CTGRY_CD
        <![CDATA[  AND T.PAVLN_DIV_CD <> '99'  ]]>
        AND GCM.POSTNET_CTGRY_YN ='N'
        AND T.PAVLN_DIV_CD NOT IN ('01','04')
        ) B , (SELECT COMN_CD_ID, COMN_CD_NM FROM CM_COMN_CD WHERE CD_GRP_ID = 'PAVLN_DIV_CD') PAVLN_DIV_CD
        WHERE  1=1
            AND B.PAVLN_DIV_CD = PAVLN_DIV_CD.COMN_CD_ID(+)
            AND A.RECEV_STUS_CD IN ( 'O02','2')
            AND A.GOODS_CD = B.GOODS_CD(+)
            AND A.SUPP_COMP_CD = B.SUPP_COMP_ID(+)
            AND A.SUPP_PO_REGI_PO_CD = F.REGIPOCD
            <isEqual property="search_amountType" compareValue="amtParcel"><!-- 소포료기준 -->
		    AND F.USEYN='Y'
		    </isEqual>
		    <isEqual property="search_amountType" compareValue="amtSale"><!-- 판매액기준 -->
		    AND (F.USEYN='Y' OR F.USEYN IS NULL)
		    </isEqual>
            AND B.PAVLN_DIV_CD IS NOT NULL
             <![CDATA[ AND A.SELL_CLOSE_YMD >= #search_strt_ymd#
	        AND A.SELL_CLOSE_YMD <= #search_end_ymd# ]]>
            AND A.RECEV_DIV_CD NOT IN ('004','021','022','050','051','052','006','040','041','042')
            <include refid="statSearchCondition" />
            GROUP BY ROLLUP(PAVLN_DIV_CD, PAVLN_DIV_CD.COMN_CD_NM , b.CTGRY_CD , B.CTGRY_NM,b.SUPP_COMP_ID ,b.BCNC_NM)
             having grouping_id(b.CTGRY_CD , B.CTGRY_NM,b.SUPP_COMP_ID ,b.BCNC_NM) in (0,3)
	</sql>
	<select id="selectStatGoodsSupplyList" 	parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
			SELECT *
				FROM ( SELECT
					<isEmpty property="search_SortType">
						ROW_NUMBER () OVER (ORDER BY PAVLN_DIV_CD ,CATEGORY_NM ASC,BCNC_NM ASC) RNUM
					</isEmpty>
					<isNotEmpty property="search_SortType">
					  <isEqual property="search_SortType" compareValue="SETLAMT">
						ROW_NUMBER () OVER (ORDER BY SETLAMT) RNUM
					  </isEqual>
					  <isEqual property="search_SortType" compareValue="SUPPGOODSCNT">
							ROW_NUMBER () OVER (ORDER BY SUPPGOODSCNT) RNUM
					  </isEqual>
					  <isEqual property="search_SortType" compareValue="CATEGORY_NM">
							ROW_NUMBER () OVER (ORDER BY CATEGORY_NM) RNUM
					  </isEqual>
					  <isEqual property="search_SortType" compareValue="goodsSupply">
					  	ROW_NUMBER () OVER (ORDER BY PAVLN_DIV_CD ,CATEGORY_NM ASC,BCNC_NM ASC) RNUM
					  </isEqual>
					   <isEqual property="search_SortType" compareValue="supplyGoods">
					  	ROW_NUMBER () OVER (ORDER BY PAVLN_DIV_CD ,BCNC_NM ASC,CATEGORY_NM ASC) RNUM
					  </isEqual>
					</isNotEmpty>
					, A.*
					FROM (
							<include refid="selectStatGoodsSupply" />
					) A
					) A
		<isNotEmpty property="firstIndex">
			WHERE RNUM BETWEEN  #firstIndex# AND #lastIndex#
		</isNotEmpty>
	</select>
	<select id="selectStatGoodsSupplyListCount" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
		SELECT COUNT(*) AS CNT
		  FROM (<include refid="selectStatGoodsSupply" />)
	</select>
	<select id="selectStatGoodsSupplyListSummary" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
		SUM(SUPPGOODSCNT) SUM_SUPPGOODSCNT,
		SUM(SETLAMT) SUM_SETLAMT,
		SUM(SELL_GOODS_CNT) SUM_SELL_GOODS_CNT
		FROM
		(
			<include refid="selectStatGoodsSupply" />
		)
	</select>

	<select id="salesStatByShop" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT  /* 파일명[파일설명] : SalesStat_SQL.xml[매장별 매출 통계 조회] SQL ID : salesStatByShop */
					 B.NAME
			        ,B.CODE
			        ,NVL(SUM_SPCLTY_SUPP_GOODS_CNT,0) AS SUM_SPCLTY_SUPP_GOODS_CNT
			        ,NVL(SUM_SPCLTY_SUPP_AMT,0) AS SUM_SPCLTY_SUPP_AMT
			        ,NVL(ON_SUM_SPCLTY_SUPP_GOODS_CNT,0) AS ON_SUM_SPCLTY_SUPP_GOODS_CNT
			        ,NVL(ON_SUM_SPCLTY_SUPP_AMT,0) AS ON_SUM_SPCLTY_SUPP_AMT
			        ,NVL(TOT_SUM_SPCLTY_SUPP_GOODS_CNT,0) AS TOT_SUM_SPCLTY_SUPP_GOODS_CNT
			        ,NVL(TOT_SUM_SPCLTY_SUPP_AMT,0) AS TOT_SUM_SPCLTY_SUPP_AMT
			FROM  (

					SELECT
							 RES.TRAN_CODE
			                ,SUM(DECODE(RES.RECEV_SYS_DIV_CD, '05', RES.SUPP_GOODS_CNT-RES.RETURN_GD_CNT,0)) AS SUM_SPCLTY_SUPP_GOODS_CNT
			                ,SUM(DECODE(RES.RECEV_SYS_DIV_CD, '05', RES.SETL_AMT-RES.RETURN_GD_AMT,0)) AS SUM_SPCLTY_SUPP_AMT
			                ,SUM(DECODE(RES.RECEV_SYS_DIV_CD, '01', RES.SUPP_GOODS_CNT-RES.RETURN_GD_CNT,
                                                              '02', RES.SUPP_GOODS_CNT-RES.RETURN_GD_CNT,
                                                              '03', RES.SUPP_GOODS_CNT-RES.RETURN_GD_CNT,
                                                              '04', RES.SUPP_GOODS_CNT-RES.RETURN_GD_CNT,
                                                              '06', RES.SUPP_GOODS_CNT-RES.RETURN_GD_CNT,0)) AS ON_SUM_SPCLTY_SUPP_GOODS_CNT
			                ,SUM(DECODE(RES.RECEV_SYS_DIV_CD, '01', RES.SETL_AMT-RES.RETURN_GD_AMT,
                                                              '02', RES.SETL_AMT-RES.RETURN_GD_AMT,
                                                              '03', RES.SETL_AMT-RES.RETURN_GD_AMT,
                                                              '04', RES.SETL_AMT-RES.RETURN_GD_AMT,
                                                              '06', RES.SETL_AMT-RES.RETURN_GD_AMT,0)) AS ON_SUM_SPCLTY_SUPP_AMT
			                ,SUM(RES.SUPP_GOODS_CNT-RES.RETURN_GD_CNT) AS TOT_SUM_SPCLTY_SUPP_GOODS_CNT
			                ,SUM(RES.SETL_AMT-RES.RETURN_GD_AMT) AS TOT_SUM_SPCLTY_SUPP_AMT

					FROM   (
					        SELECT
					                 a.RECEV_DIV_CD
		                            ,a.RECEV_SYS_DIV_CD
		                            ,a.SUPP_GOODS_CNT
		                            ,a.RETURN_GD_CNT
		                            ,a.SETL_AMT
		                            ,a.RETURN_GD_AMT
		                            ,DECODE(a.RECEV_DIV_CD
					                            ,'001','01'
					                            ,'008','07'
					                            ,'011','01'
					                            ,'015','01'
					                            ,'019','07'
					                            ,'020','07'
					                            ,'005','02'
					                            ,'017','02'
					                            ,'018','02'
					                            ,'004','03'
					                            ,'021','03'
					                            ,'022','03'
					                            ,'002','04'
					                            ,'012','04'
					                            ,'016','04'
					                            ,'014','05'
					                            ,'031','05'
					                            ,'032','05'
					                            ,'060','051'
					                            ,'061','051'
					                            ,'062','051'
					                            ,'006','08'
					                            ,'040','08'
					                            ,'041','08'
					                            ,'042','08'
					                            ,'050','09'
					                            ,'051','09'
					                            ,'052','09','') AS TRAN_CODE
					        FROM
					                MP_POST_SHOP_SUPP_DAY a
					                ,(SELECT  RCOCD
					                         ,REGIPOCD
					                  FROM    PICMT0060
					                  WHERE   USEYN='Y') b

					        WHERE   a.SUPP_PO_REGI_PO_CD = b.REGIPOCD
					        AND     a.RECEV_STUS_CD IN ( 'O02','2')
					        AND     a.RECEV_DIV_CD <> '003'
				]]>
					        <isNotEmpty property="search_pavlan">
					            <isEqual property="search_pavlan" compareValue="01">
					        		AND	  a.RECEV_DIV_CD IN ('001','011','015')
					        	</isEqual>
					        	<isEqual property="search_pavlan" compareValue="02">
					        		AND	  a.RECEV_DIV_CD IN ('005','017','018')
					        	</isEqual>
					        	<isEqual property="search_pavlan" compareValue="03">
					        		AND	  a.RECEV_DIV_CD IN ('004','021','022')
					        	</isEqual>
					        	<isEqual property="search_pavlan" compareValue="04">
					        		AND	  a.RECEV_DIV_CD IN ('002','012','016')
					        	</isEqual>
					        	<isEqual property="search_pavlan" compareValue="05">
					        		AND	  a.RECEV_DIV_CD IN ('014','031','032')
					        	</isEqual>
					        	<isEqual property="search_pavlan" compareValue="051">
					        		AND	  a.RECEV_DIV_CD IN ('060','061','062')
					        	</isEqual>
					        	<isEqual property="search_pavlan" compareValue="07">
					        		AND	  a.RECEV_DIV_CD IN ('008','019','020')
					        	</isEqual>
					        	<isEqual property="search_pavlan" compareValue="08">
					        		AND	  a.RECEV_DIV_CD IN ('006','040','041','042')
					        	</isEqual>
					        	<isEqual property="search_pavlan" compareValue="09">
					        		AND	  a.RECEV_DIV_CD IN ('050','051','052')
					        	</isEqual>
					        </isNotEmpty>
				<![CDATA[
					        AND    TO_DATE(a.SELL_CLOSE_YMD,'yyyymmdd') BETWEEN TO_DATE(#searchFromDt#,'yyyymmdd') AND TO_DATE(#searchToDt#,'yyyymmdd') ) RES
			        GROUP BY RES.TRAN_CODE
			        ) A,
			        (
			         SELECT
			                T2.COMN_CD_ID AS CODE,
			                T2.COMN_CD_NM AS NAME
			         FROM   CM_COMN_CD_GRP T1,
			                CM_COMN_CD T2
			         WHERE T1.CD_GRP_ID = T2.CD_GRP_ID
			         AND T1.CD_GRP_ID = 'PAVLN_DIV_CD'
			         AND T2.USE_YN = 'Y'
			         AND T2.COMN_CD_ID NOT IN ('06','93','99')
			         UNION
                     SELECT '051','해외배송(전통시장)' FROM DUAL) B

			WHERE  A.TRAN_CODE(+) = B.CODE
		]]>
			<isNotEmpty property="search_pavlan">
				AND    B.CODE = #search_pavlan#
			</isNotEmpty>
		<![CDATA[
			ORDER BY TRAN_CODE ASC
		]]>
	</select>
</sqlMap>
